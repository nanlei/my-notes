{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u672c\u9879\u76ee\u4e3a\u6280\u672f\u535a\u5ba2","title":"Home"},{"location":"about/","text":"\u5f53\u524d\u5185\u5bb9 + \u6846\u67b6\uff1aSpring Boot + \u6570\u636e\u5e93\uff1aMySQL + \u8fd0\u7ef4\uff1aDocker","title":"Who Am I"},{"location":"SpringBoot/01-spring-boot-application/","text":"01 - Spring Boot \u5e94\u7528\u7a0b\u5e8f 1. \u4f7f\u7528Maven\u547d\u4ee4\u884c\u6784\u5efa\u9879\u76ee \u00b6 $ mvn archetype:generate -DgroupId=deep-in-spring-boot -DartifactId=first-spring-boot-application -Dversion=1.0.0-SNAPSHOT -DinteractiveMode=false -Dpackage=deep.in.spring.boot \u7c7b\u4f3c\u7ed3\u679c\uff1a [INFO] Scanning for projects... ([INFO] [INFO] ------------------< org.apache.maven:standalone-pom >------------------- [INFO] Building Maven Stub Project (No POM) 1 [INFO] --------------------------------[ pom ]--------------------------------- [INFO] [INFO] >>> maven-archetype-plugin:3.2.0:generate (default-cli) > generate-sources @ standalone-pom >>> [INFO] [INFO] <<< maven-archetype-plugin:3.2.0:generate (default-cli) < generate-sources @ standalone-pom <<< [INFO] [INFO] ) [INFO] --- maven-archetype-plugin:3.2.0:generate (default-cli) @ standalone-pom --- [INFO] Generating project in Batch mode [WARNING] No archetype found in remote catalog. Defaulting to internal catalog [INFO] No archetype defined. Using maven-archetype-quickstart (org.apache.maven.archetypes:maven-archetype-quickstart:1.0) [INFO] ---------------------------------------------------------------------------- [INFO] Using following parameters for creating project from Old (1.x) Archetype: maven-archetype-quickstart:1.0 [INFO] ---------------------------------------------------------------------------- [INFO] Parameter: basedir, Value: /Users/nanlei/Dev/Workspace [INFO] Parameter: package, Value: deep.in.spring.boot [INFO] Parameter: groupId, Value: deep-in-spring-boot [INFO] Parameter: artifactId, Value: first-spring-boot-application [INFO] Parameter: packageName, Value: deep.in.spring.boot [INFO] Parameter: version, Value: 1.0.0-SNAPSHOT [INFO] project created from Old (1.x) Archetype in dir: /Users/nanlei/Dev/Workspace/first-spring-boot-application [INFO] ------------------------------------------------------------------------ [INFO] BUILD SUCCESS [INFO] ------------------------------------------------------------------------ [INFO] Total time: 1.475 s [INFO] Finished at: 2020-08-01T23:51:37+08:00 archetype \u662fMaven\u63d2\u4ef6 maven-archetype-plugin \u7684\u7b80\u79f0 \u63d2\u4ef6\u76ee\u6807\uff1a archetype:generate \u63d2\u4ef6\u53c2\u6570\uff1aGAV\u4fe1\u606f groupId \uff0c artifactId \uff0c version \u548c\u5305\u540d package \u4ea4\u4e92\u5f0f\u53c2\u6570\uff1a interactiveMode \u4e3a false \uff0c\u4f7f\u7528\u9759\u9ed8\u65b9\u5f0f \u67e5\u770b\u9879\u76ee\u7ed3\u6784\uff1a $ cd first-spring-boot-application/ $ ls -ls total 8 8 -rw-r--r-- 1 nanlei staff 692 Aug 1 23:51 pom.xml 0 drwxr-xr-x 4 nanlei staff 128 Aug 1 23:51 src \u5b89\u88c5tree\u7ec4\u4ef6\u5e76\u518d\u6b21\u67e5\u770b\uff1a $ brew install tree ==> Downloading https://mirrors.aliyun.com/homebrew/homebrew-bottles/bottles/tree-1.8.0.catalina.bottle.tar. ######################################################################## 100.0% ==> Pouring tree-1.8.0.catalina.bottle.tar.gz \ud83c\udf7a /usr/local/Cellar/tree/1.8.0: 8 files, 121.1KB $ tree . \u251c\u2500\u2500 pom.xml \u2514\u2500\u2500 src \u251c\u2500\u2500 main \u2502 \u2514\u2500\u2500 java \u2502 \u2514\u2500\u2500 deep \u2502 \u2514\u2500\u2500 in \u2502 \u2514\u2500\u2500 spring \u2502 \u2514\u2500\u2500 boot \u2502 \u2514\u2500\u2500 App.java \u2514\u2500\u2500 test \u2514\u2500\u2500 java \u2514\u2500\u2500 deep \u2514\u2500\u2500 in \u2514\u2500\u2500 spring \u2514\u2500\u2500 boot \u2514\u2500\u2500 AppTest.java 13 directories, 3 files App.java \u662f\u5f15\u5bfc\u7c7b\uff0c AppTest.java \u662f\u5355\u5143\u6d4b\u8bd5\u7c7b \u5728 pom.xml \u4e2d\uff0c archetype \u63d2\u4ef6\u6dfb\u52a0\u4e86 junit \u7684\u4f9d\u8d56 \u5728 pom.xml \u4e2d\u6dfb\u52a0Spring Boot\u7684web\u4f9d\u8d56\uff1a <dependency> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-starter-web </artifactId> <version> 2.3.1.RELEASE </version> </dependency> \u67e5\u770b\u9879\u76ee dependency \u6811\u7684\u53d8\u5316\uff1a $ mvn dependency:tree -Dincludes=org.springframework* [INFO] Scanning for projects... [INFO] [INFO] ---------< deep-in-spring-boot:first-spring-boot-application >---------- [INFO] Building first-spring-boot-application 1.0.0-SNAPSHOT [INFO] --------------------------------[ jar ]--------------------------------- [INFO] [INFO] --- maven-dependency-plugin:2.8:tree (default-cli) @ first-spring-boot-application --- [INFO] deep-in-spring-boot:first-spring-boot-application:jar:1.0.0-SNAPSHOT [INFO] \\- org.springframework.boot:spring-boot-starter-web:jar:2.3.1.RELEASE:compile [INFO] +- org.springframework.boot:spring-boot-starter:jar:2.3.1.RELEASE:compile [INFO] | +- org.springframework.boot:spring-boot:jar:2.3.1.RELEASE:compile [INFO] | +- org.springframework.boot:spring-boot-autoconfigure:jar:2.3.1.RELEASE:compile [INFO] | +- org.springframework.boot:spring-boot-starter-logging:jar:2.3.1.RELEASE:compile [INFO] | \\- org.springframework:spring-core:jar:5.2.7.RELEASE:compile [INFO] | \\- org.springframework:spring-jcl:jar:5.2.7.RELEASE:compile [INFO] +- org.springframework.boot:spring-boot-starter-json:jar:2.3.1.RELEASE:compile [INFO] +- org.springframework.boot:spring-boot-starter-tomcat:jar:2.3.1.RELEASE:compile [INFO] +- org.springframework:spring-web:jar:5.2.7.RELEASE:compile [INFO] | \\- org.springframework:spring-beans:jar:5.2.7.RELEASE:compile [INFO] \\- org.springframework:spring-webmvc:jar:5.2.7.RELEASE:compile [INFO] +- org.springframework:spring-aop:jar:5.2.7.RELEASE:compile [INFO] +- org.springframework:spring-context:jar:5.2.7.RELEASE:compile [INFO] \\- org.springframework:spring-expression:jar:5.2.7.RELEASE:compile [INFO] ------------------------------------------------------------------------ [INFO] BUILD SUCCESS [INFO] ------------------------------------------------------------------------ [INFO] Total time: 0.802 s [INFO] Finished at: 2020-08-02T00:45:55+08:00 [INFO] ------------------------------------------------------------------------ \u7f16\u5199 App.java \u4ee3\u7801\uff1a @RestController @SpringBootApplication public class App { @RequestMapping ( \"/\" ) public String index () { return \"Welcome to Spring Boot!\" ; } public static void main ( String [] args ) { SpringApplication . run ( App . class , args ); } } \u4f7f\u7528Maven\u63d2\u4ef6\u65b9\u5f0f mvn spring-boot:run \u8fd0\u884c\u9879\u76ee\uff1a $ mvn spring-boot:run [INFO] Scanning for projects... Downloading from aliyun-maven: http://maven.aliyun.com/nexus/content/groups/public/org/apache/maven/plugins/maven-metadata.xml Downloading from aliyun-maven: http://maven.aliyun.com/nexus/content/groups/public/org/codehaus/mojo/maven-metadata.xml Downloaded from aliyun-maven: http://maven.aliyun.com/nexus/content/groups/public/org/apache/maven/plugins/maven-metadata.xml (9.9 kB at 4.4 kB/s) Downloaded from aliyun-maven: http://maven.aliyun.com/nexus/content/groups/public/org/codehaus/mojo/maven-metadata.xml (21 kB at 8.7 kB/s) [INFO] ------------------------------------------------------------------------ [INFO] BUILD FAILURE [INFO] ------------------------------------------------------------------------ [INFO] Total time: 2.835 s [INFO] Finished at: 2020-08-02T01:00:07+08:00 [INFO] ------------------------------------------------------------------------ [ERROR] No plugin found for prefix 'spring-boot' in the current project and in the plugin groups [org.apache.maven.plugins, org.codehaus.mojo] available from the repositories [local (/Users/nanlei/.m2/repository), aliyun-maven (http://maven.aliyun.com/nexus/content/groups/public/)] -> [Help 1] [ERROR] [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch. [ERROR] Re-run Maven using the -X switch to enable full debug logging. [ERROR] [ERROR] For more information about the errors and possible solutions, please read the following articles: [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/NoPluginFoundForPrefixException \u67e5\u770b\u5b98\u65b9\u6587\u6863 https://docs.spring.io/spring-boot/docs/current/reference \u6709\u5982\u4e0b\u5185\u5bb9\uff1a 2.4.4. Running the Example At this point, your application should work. Since you used the spring-boot-starter-parent POM, you have a useful run goal that you can use to start the application. Type mvn spring-boot:run from the root project directory to start the application. \u5728 pom.xml \u4e2d\u6dfb\u52a0 spring-boot-starter-parent \uff1a <parent> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-starter-parent </artifactId> <version> 2.3.1.RELEASE </version> </parent> \u518d\u6b21\u8fd0\u884c\uff1a $ mvn spring-boot:run [INFO] Scanning for projects... [INFO] [INFO] ---------< deep-in-spring-boot:first-spring-boot-application >---------- [INFO] Building first-spring-boot-application 1.0.0-SNAPSHOT [INFO] --------------------------------[ jar ]--------------------------------- [INFO] [INFO] >>> spring-boot-maven-plugin:2.3.1.RELEASE:run (default-cli) > test-compile @ first-spring-boot-application >>> [INFO] [INFO] --- maven-resources-plugin:3.1.0:resources (default-resources) @ first-spring-boot-application --- [INFO] Using 'UTF-8' encoding to copy filtered resources. [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/main/resources [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/main/resources [INFO] [INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ first-spring-boot-application --- [INFO] Nothing to compile - all classes are up to date [INFO] [INFO] --- maven-resources-plugin:3.1.0:testResources (default-testResources) @ first-spring-boot-application --- [INFO] Using 'UTF-8' encoding to copy filtered resources. [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/test/resources [INFO] [INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ first-spring-boot-application --- [INFO] Nothing to compile - all classes are up to date [INFO] [INFO] <<< spring-boot-maven-plugin:2.3.1.RELEASE:run (default-cli) < test-compile @ first-spring-boot-application <<< [INFO] [INFO] [INFO] --- spring-boot-maven-plugin:2.3.1.RELEASE:run (default-cli) @ first-spring-boot-application --- [INFO] Attaching agents: [] . ____ _ __ _ _ /\\\\ / ___'_ __ _ _(_)_ __ __ _ \\ \\ \\ \\ ( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| | ) ) ) ) ' |____| .__|_| |_|_| |_\\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: (v2.3.1.RELEASE) 2020-08-02 01:13:46.642 INFO 6736 --- [ main] deep.in.spring.boot.App : Starting App on nanleis-MacBook-Pro.local with PID 6736 (/Users/nanlei/Dev/Workspace/first-spring-boot-application/target/classes started by nanlei in /Users/nanlei/Dev/Workspace/first-spring-boot-application) 2020-08-02 01:13:46.644 INFO 6736 --- [ main] deep.in.spring.boot.App : No active profile set, falling back to default profiles: default 2020-08-02 01:13:47.141 INFO 6736 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat initialized with port(s): 8080 (http) 2020-08-02 01:13:47.147 INFO 6736 --- [ main] o.apache.catalina.core.StandardService : Starting service [Tomcat] 2020-08-02 01:13:47.148 INFO 6736 --- [ main] org.apache.catalina.core.StandardEngine : Starting Servlet engine: [Apache Tomcat/9.0.36] 2020-08-02 01:13:47.181 INFO 6736 --- [ main] o.a.c.c.C.[Tomcat].[localhost].[/] : Initializing Spring embedded WebApplicationContext 2020-08-02 01:13:47.181 INFO 6736 --- [ main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 507 ms 2020-08-02 01:13:47.268 INFO 6736 --- [ main] o.s.s.concurrent.ThreadPoolTaskExecutor : Initializing ExecutorService 'applicationTaskExecutor' 2020-08-02 01:13:47.352 INFO 6736 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat started on port(s): 8080 (http) with context path '' 2020-08-02 01:13:47.359 INFO 6736 --- [ main] deep.in.spring.boot.App : Started App in 0.917 seconds (JVM running for 1.155) \u68c0\u67e5HTTP\u670d\u52a1\u548c\u6240\u5199\u4ee3\u7801\uff1a $ curl http://127.0.0.1:8080/ Welcome to Spring Boot 2. \u56fe\u5f62\u5316\u6784\u5efaSpring Boot\u5e94\u7528 \u00b6 https://start.spring.io/ \u62f7\u8d1d\u751f\u6210\u597d\u7684zip\u5305\u5230\u9879\u76ee\u76ee\u5f55\uff1a $ cp ~/Downloads/first-application-by-gui.zip . \u89e3\u538b\u7f29\u8be5\u6587\u4ef6\uff1a $ unzip first-application-by-gui.zip Archive: first-application-by-gui.zip creating: first-application-by-gui/ creating: first-application-by-gui/.mvn/ creating: first-application-by-gui/.mvn/wrapper/ inflating: first-application-by-gui/.mvn/wrapper/maven-wrapper.properties inflating: first-application-by-gui/.mvn/wrapper/MavenWrapperDownloader.java inflating: first-application-by-gui/.mvn/wrapper/maven-wrapper.jar inflating: first-application-by-gui/mvnw inflating: first-application-by-gui/.gitignore inflating: first-application-by-gui/HELP.md inflating: first-application-by-gui/mvnw.cmd creating: first-application-by-gui/src/ creating: first-application-by-gui/src/main/ creating: first-application-by-gui/src/main/resources/ creating: first-application-by-gui/src/main/resources/templates/ inflating: first-application-by-gui/src/main/resources/application.properties creating: first-application-by-gui/src/main/resources/static/ creating: first-application-by-gui/src/main/java/ creating: first-application-by-gui/src/main/java/deep/ creating: first-application-by-gui/src/main/java/deep/in/ creating: first-application-by-gui/src/main/java/deep/in/spring/ creating: first-application-by-gui/src/main/java/deep/in/spring/boot/ inflating: first-application-by-gui/src/main/java/deep/in/spring/boot/FirstApplicationByGuiApplication.java creating: first-application-by-gui/src/test/ creating: first-application-by-gui/src/test/java/ creating: first-application-by-gui/src/test/java/deep/ creating: first-application-by-gui/src/test/java/deep/in/ creating: first-application-by-gui/src/test/java/deep/in/spring/ creating: first-application-by-gui/src/test/java/deep/in/spring/boot/ inflating: first-application-by-gui/src/test/java/deep/in/spring/boot/FirstApplicationByGuiApplicationTests.java inflating: first-application-by-gui/pom.xml \u4f7f\u7528 tree \u547d\u4ee4\u67e5\u770b\uff1a $ tree -a first-application-by-gui first-application-by-gui \u251c\u2500\u2500 .gitignore \u251c\u2500\u2500 .mvn \u2502 \u2514\u2500\u2500 wrapper \u2502 \u251c\u2500\u2500 MavenWrapperDownloader.java \u2502 \u251c\u2500\u2500 maven-wrapper.jar \u2502 \u2514\u2500\u2500 maven-wrapper.properties \u251c\u2500\u2500 HELP.md \u251c\u2500\u2500 mvnw \u251c\u2500\u2500 mvnw.cmd \u251c\u2500\u2500 pom.xml \u2514\u2500\u2500 src \u251c\u2500\u2500 main \u2502 \u251c\u2500\u2500 java \u2502 \u2502 \u2514\u2500\u2500 deep \u2502 \u2502 \u2514\u2500\u2500 in \u2502 \u2502 \u2514\u2500\u2500 spring \u2502 \u2502 \u2514\u2500\u2500 boot \u2502 \u2502 \u2514\u2500\u2500 FirstApplicationByGuiApplication.java \u2502 \u2514\u2500\u2500 resources \u2502 \u251c\u2500\u2500 application.properties \u2502 \u251c\u2500\u2500 static \u2502 \u2514\u2500\u2500 templates \u2514\u2500\u2500 test \u2514\u2500\u2500 java \u2514\u2500\u2500 deep \u2514\u2500\u2500 in \u2514\u2500\u2500 spring \u2514\u2500\u2500 boot \u2514\u2500\u2500 FirstApplicationByGuiApplicationTests.java 18 directories, 11 files .gitignore \u6587\u4ef6\u5b9a\u4e49\u4e86\u5e38\u89c1\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u7248\u672c\u63a7\u5236\u5ffd\u7565\u540d\u5355\uff0c\u6bd4\u5982\uff1a HELP.md target/ !.mvn/wrapper/maven-wrapper.jar !**/src/main/**/target/ !**/src/test/**/target/ ### STS ### .apt_generated .classpath .factorypath .project .settings .springBeans .sts4-cache ### IntelliJ IDEA ### .idea *.iws *.iml *.ipr ### NetBeans ### /nbproject/private/ /nbbuild/ /dist/ /nbdist/ /.nb-gradle/ build/ !**/src/main/**/build/ !**/src/test/**/build/ ### VS Code ### .vscode/ Maven Wrapper\u6587\u4ef6\u5305\u542b .mvn \u76ee\u5f55\u3001 mvnw \u548c mvnw.cmd \u6587\u4ef6\uff0c \u53c2\u8003\uff1a https://github.com/takari/maven-wrapper \u53ef\u4ee5\u4e0d\u5b89\u88c5Maven\u800c\u76f4\u63a5\u4f7f\u7528\uff0c\u6bd4\u5982\uff1a Normally you instruct users to install a specific version of Apache Maven, put it on the PATH and then run the mvn command like the following: mvn clean install But now, with a Maven Wrapper setup, you can instruct users to run wrapper scripts: ./mvnw clean install application.properties \u6587\u4ef6 \u662fSpring Boot\u9ed8\u8ba4\u7684\u5e94\u7528\u5916\u90e8\u914d\u7f6e\u6587\u4ef6\uff0c\u5176\u914d\u7f6e\u5c5e\u6027\u53ef\u4ee5\u5f71\u54cd\u5e94\u7528\u7a0b\u5e8f\u7684\u884c\u4e3a\u3002 FirstApplicationByGuiApplicationTests.java \u6587\u4ef6 \u662fSpring Boot\u5355\u5143\u6d4b\u8bd5\u7684\u6a21\u7248JUnit\u6587\u4ef6\uff0c\u5176\u8def\u5f84\u548c\u5bf9\u5e94\u7684\u5f15\u5bfc\u6587\u4ef6 FirstApplicationByGuiApplication.java \u5bf9\u5e94\u3002 \u542f\u52a8\u9879\u76ee\u5e76\u8bbf\u95ee\uff1a $ curl http://127.0.0.1:8080/ {\"timestamp\":\"2020-08-02T08:57:15.817+00:00\",\"status\":404,\"error\":\"Not Found\",\"message\":\"\",\"path\":\"/\"} \u56e0\u9879\u76ee\u6ca1\u6709\u7f16\u5199\u9ed8\u8ba4\u670d\u52a1\u800c\u62a5404\u9519\u8bef \u5b89\u88c5 jsonpp \u67e5\u770bJSON\u54cd\u5e94\uff1a $ brew install jsonpp ==> Downloading https://mirrors.aliyun.com/homebrew/homebrew-bottles/bottles/jsonpp-1.3.0_1.catalina.bottle.tar.gz ######################################################################## 100.0% ==> Pouring jsonpp-1.3.0_1.catalina.bottle.tar.gz \ud83c\udf7a /usr/local/Cellar/jsonpp/1.3.0_1: 5 files, 2.4MB \u518d\u6b21\u8bbf\u95ee\uff1a $ curl http://127.0.0.1:8080 | jsonpp % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 102 0 102 0 0 20400 0 --:--:-- --:--:-- --:--:-- 20400 { \"timestamp\": \"2020-08-02T09:03:24.359+00:00\", \"status\": 404, \"error\": \"Not Found\", \"message\": \"\", \"path\": \"/\" } 3. \u521b\u5efaSpring Boot\u5e94\u7528\u7a0b\u5e8f\u7684\u53ef\u6267\u884cJAR \u00b6 2.4.5. Creating an Executable Jar We finish our example by creating a completely self-contained executable jar file that we could run in production. Executable jars (sometimes called \u201cfat jars\u201d) are archives containing your compiled classes along with all of the jar dependencies that your code needs to run. \u53ef\u6267\u884c\u7684JAR\u53c8\u79f0\u4e3a\u201cfat jars\u201d To create an executable jar, we need to add the spring-boot-maven-plugin to our pom.xml . To do so, insert the following lines just below the dependencies section: \u6839\u636e\u5b98\u65b9\u6587\u6863\u89e3\u91ca\uff0c\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9\u5230 pom.xml \u4e2d\uff1a <build> <plugins> <plugin> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-maven-plugin </artifactId> </plugin> </plugins> </build> \u7136\u540e\u6267\u884c mvn package \u547d\u4ee4\uff1a $ mvn package [INFO] Scanning for projects... [INFO] [INFO] ------------< deep-in-spring-boot:first-application-by-gui >------------ [INFO] Building first-application-by-gui 0.0.1-SNAPSHOT [INFO] --------------------------------[ jar ]--------------------------------- (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) [INFO] ------------------------------------------------------- [INFO] T E S T S [INFO] ------------------------------------------------------- (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) . ____ _ __ _ _ /\\\\ / ___'_ __ _ _(_)_ __ __ _ \\ \\ \\ \\ ( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| | ) ) ) ) ' |____| .__|_| |_|_| |_\\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: (v2.3.2.RELEASE) 2020-08-02 17:15:06.025 INFO 4060 --- [ main] .b.FirstApplicationByGuiApplicationTests : Starting FirstApplicationByGuiApplicationTests on nanleis-MacBook-Pro.local with PID 4060 (started by nanlei in /Users/nanlei/Dev/Workspace/first-application-by-gui) 2020-08-02 17:15:06.026 INFO 4060 --- [ main] .b.FirstApplicationByGuiApplicationTests : No active profile set, falling back to default profiles: default 2020-08-02 17:15:06.709 INFO 4060 --- [ main] o.s.s.concurrent.ThreadPoolTaskExecutor : Initializing ExecutorService 'applicationTaskExecutor' 2020-08-02 17:15:06.958 INFO 4060 --- [ main] .b.FirstApplicationByGuiApplicationTests : Started FirstApplicationByGuiApplicationTests in 1.075 seconds (JVM running for 1.706) [INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.508 s - in deep.in.spring.boot.FirstApplicationByGuiApplicationTests 2020-08-02 17:15:07.127 INFO 4060 --- [extShutdownHook] o.s.s.concurrent.ThreadPoolTaskExecutor : Shutting down ExecutorService 'applicationTaskExecutor' [INFO] [INFO] Results: [INFO] [INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0 [INFO] [INFO] [INFO] --- maven-jar-plugin:3.2.0:jar (default-jar) @ first-application-by-gui --- [INFO] Building jar: /Users/nanlei/Dev/Workspace/first-application-by-gui/target/first-application-by-gui-0.0.1-SNAPSHOT.jar [INFO] [INFO] --- spring-boot-maven-plugin:2.3.2.RELEASE:repackage (repackage) @ first-application-by-gui --- [INFO] Replacing main artifact with repackaged archive [INFO] ------------------------------------------------------------------------ [INFO] BUILD SUCCESS [INFO] ------------------------------------------------------------------------ [INFO] Total time: 3.535 s [INFO] Finished at: 2020-08-02T17:15:07+08:00 [INFO] ------------------------------------------------------------------------ \u6700\u7ec8\u751f\u6210\u7684 first-application-by-gui-0.0.1-SNAPSHOT.jar \u5c31\u5728 target \u76ee\u5f55\u4e0b\uff0c\u4f7f\u7528 java -jar \u547d\u4ee4\u8fd0\u884cJAR\uff1a $ java -jar target/first-application-by-gui-0.0.1-SNAPSHOT.jar . ____ _ __ _ _ /\\\\ / ___'_ __ _ _(_)_ __ __ _ \\ \\ \\ \\ ( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| | ) ) ) ) ' |____| .__|_| |_|_| |_\\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: (v2.3.2.RELEASE) 2020-08-02 17:24:33.034 INFO 4219 --- [ main] d.i.s.b.FirstApplicationByGuiApplication : Starting FirstApplicationByGuiApplication v0.0.1-SNAPSHOT on nanleis-MacBook-Pro.local with PID 4219 (/Users/nanlei/Dev/Workspace/first-application-by-gui/target/first-application-by-gui-0.0.1-SNAPSHOT.jar started by nanlei in /Users/nanlei/Dev/Workspace/first-application-by-gui) 2020-08-02 17:24:33.036 INFO 4219 --- [ main] d.i.s.b.FirstApplicationByGuiApplication : No active profile set, falling back to default profiles: default 2020-08-02 17:24:33.800 INFO 4219 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat initialized with port(s): 8080 (http) 2020-08-02 17:24:33.809 INFO 4219 --- [ main] o.apache.catalina.core.StandardService : Starting service [Tomcat] 2020-08-02 17:24:33.810 INFO 4219 --- [ main] org.apache.catalina.core.StandardEngine : Starting Servlet engine: [Apache Tomcat/9.0.37] 2020-08-02 17:24:33.865 INFO 4219 --- [ main] o.a.c.c.C.[Tomcat].[localhost].[/] : Initializing Spring embedded WebApplicationContext 2020-08-02 17:24:33.865 INFO 4219 --- [ main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 785 ms 2020-08-02 17:24:34.031 INFO 4219 --- [ main] o.s.s.concurrent.ThreadPoolTaskExecutor : Initializing ExecutorService 'applicationTaskExecutor' 2020-08-02 17:24:34.221 INFO 4219 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat started on port(s): 8080 (http) with context path '' 2020-08-02 17:24:34.231 INFO 4219 --- [ main] d.i.s.b.FirstApplicationByGuiApplication : Started FirstApplicationByGuiApplication in 1.523 seconds (JVM running for 1.894) java -jar \u65b9\u5f0f\u548c mvn spring-boot:run \u65b9\u5f0f\u57fa\u672c\u65e0\u5f02 4. Spring Boot\u53ef\u6267\u884cJAR\u8d44\u6e90\u7ed3\u6784 \u00b6 \u5728 target \u76ee\u5f55\u4e0b\u6267\u884c tree -h $ tree -h . \u251c\u2500\u2500 [ 128] classes \u2502 \u251c\u2500\u2500 [ 1] application.properties \u2502 \u2514\u2500\u2500 [ 96] deep \u2502 \u2514\u2500\u2500 [ 96] in \u2502 \u2514\u2500\u2500 [ 96] spring \u2502 \u2514\u2500\u2500 [ 96] boot \u2502 \u2514\u2500\u2500 [ 790] FirstApplicationByGuiApplication.class \u251c\u2500\u2500 [ 16M] first-application-by-gui-0.0.1-SNAPSHOT.jar \u251c\u2500\u2500 [3.0K] first-application-by-gui-0.0.1-SNAPSHOT.jar.original \u251c\u2500\u2500 [ 96] generated-sources \u2502 \u2514\u2500\u2500 [ 64] annotations \u251c\u2500\u2500 [ 96] generated-test-sources \u2502 \u2514\u2500\u2500 [ 64] test-annotations \u251c\u2500\u2500 [ 96] maven-archiver \u2502 \u2514\u2500\u2500 [ 87] pom.properties \u251c\u2500\u2500 [ 96] maven-status \u2502 \u2514\u2500\u2500 [ 128] maven-compiler-plugin \u2502 \u251c\u2500\u2500 [ 96] compile \u2502 \u2502 \u2514\u2500\u2500 [ 128] default-compile \u2502 \u2502 \u251c\u2500\u2500 [ 59] createdFiles.lst \u2502 \u2502 \u2514\u2500\u2500 [ 125] inputFiles.lst \u2502 \u2514\u2500\u2500 [ 96] testCompile \u2502 \u2514\u2500\u2500 [ 128] default-testCompile \u2502 \u251c\u2500\u2500 [ 64] createdFiles.lst \u2502 \u2514\u2500\u2500 [ 130] inputFiles.lst \u251c\u2500\u2500 [ 128] surefire-reports \u2502 \u251c\u2500\u2500 [ 18K] TEST-deep.in.spring.boot.FirstApplicationByGuiApplicationTests.xml \u2502 \u2514\u2500\u2500 [ 363] deep.in.spring.boot.FirstApplicationByGuiApplicationTests.txt \u2514\u2500\u2500 [ 96] test-classes \u2514\u2500\u2500 [ 96] deep \u2514\u2500\u2500 [ 96] in \u2514\u2500\u2500 [ 96] spring \u2514\u2500\u2500 [ 96] boot \u2514\u2500\u2500 [ 588] FirstApplicationByGuiApplicationTests.class 22 directories, 12 files first-application-by-gui-0.0.1-SNAPSHOT.jar.original \u662f\u672a\u5305\u542b\u7b2c\u4e09\u65b9\u4f9d\u8d56\u7684\u672c\u5730\u8d44\u6e90(\u7f16\u8bd1\u540e\u7684 classes \u76ee\u5f55\u4e0b\u7684\u8d44\u6e90)\uff0c\u6240\u5360\u7a7a\u95f4\u4ec53K\uff0c\u800c\u53ef\u6267\u884cJAR\u7684\u5927\u5c0f\u4e3a16M\u3002 \u89e3\u538b\u7f29 first-application-by-gui-0.0.1-SNAPSHOT.jar \u5230\u4e34\u65f6\u76ee\u5f55temp\u5e76\u67e5\u770b\uff1a $ unzip first-application-by-gui-0.0.1-SNAPSHOT.jar -d temp Archive: first-application-by-gui-0.0.1-SNAPSHOT.jar creating: temp/META-INF/ inflating: temp/META-INF/MANIFEST.MF creating: temp/org/ creating: temp/org/springframework/ creating: temp/org/springframework/boot/ creating: temp/org/springframework/boot/loader/ (\u7701\u7565\u90e8\u5206\u5185\u5bb9) extracting: temp/BOOT-INF/lib/tomcat-embed-websocket-9.0.37.jar extracting: temp/BOOT-INF/lib/spring-web-5.2.8.RELEASE.jar extracting: temp/BOOT-INF/lib/spring-beans-5.2.8.RELEASE.jar extracting: temp/BOOT-INF/lib/spring-webmvc-5.2.8.RELEASE.jar extracting: temp/BOOT-INF/lib/spring-aop-5.2.8.RELEASE.jar extracting: temp/BOOT-INF/lib/spring-context-5.2.8.RELEASE.jar extracting: temp/BOOT-INF/lib/spring-expression-5.2.8.RELEASE.jar extracting: temp/BOOT-INF/lib/slf4j-api-1.7.30.jar extracting: temp/BOOT-INF/lib/spring-core-5.2.8.RELEASE.jar extracting: temp/BOOT-INF/lib/spring-jcl-5.2.8.RELEASE.jar inflating: temp/BOOT-INF/classpath.idx \u67e5\u770btemp\u76ee\u5f55\u7684\u7ed3\u6784\uff1a $ tree temp/ temp/ \u251c\u2500\u2500 BOOT-INF \u2502 \u251c\u2500\u2500 classes \u2502 \u2502 \u251c\u2500\u2500 application.properties \u2502 \u2502 \u2514\u2500\u2500 deep \u2502 \u2502 \u2514\u2500\u2500 in \u2502 \u2502 \u2514\u2500\u2500 spring \u2502 \u2502 \u2514\u2500\u2500 boot \u2502 \u2502 \u2514\u2500\u2500 FirstApplicationByGuiApplication.class \u2502 \u251c\u2500\u2500 classpath.idx \u2502 \u2514\u2500\u2500 lib \u2502 \u251c\u2500\u2500 ... \u2502 \u251c\u2500\u2500 spring-aop-5.2.8.RELEASE.jar \u2502 \u251c\u2500\u2500 spring-beans-5.2.8.RELEASE.jar \u2502 \u251c\u2500\u2500 spring-boot-2.3.2.RELEASE.jar \u2502 \u251c\u2500\u2500 spring-boot-autoconfigure-2.3.2.RELEASE.jar \u2502 \u251c\u2500\u2500 ... \u2502 \u251c\u2500\u2500 tomcat-embed-core-9.0.37.jar \u2502 \u2514\u2500\u2500 tomcat-embed-websocket-9.0.37.jar \u251c\u2500\u2500 META-INF \u2502 \u251c\u2500\u2500 MANIFEST.MF \u2502 \u2514\u2500\u2500 maven \u2502 \u2514\u2500\u2500 deep-in-spring-boot \u2502 \u2514\u2500\u2500 first-application-by-gui \u2502 \u251c\u2500\u2500 pom.properties \u2502 \u2514\u2500\u2500 pom.xml \u2514\u2500\u2500 org \u2514\u2500\u2500 springframework \u2514\u2500\u2500 boot \u2514\u2500\u2500 loader \u251c\u2500\u2500 ClassPathIndexFile.class \u251c\u2500\u2500 ExecutableArchiveLauncher.class \u251c\u2500\u2500 JarLauncher.class \u251c\u2500\u2500 ... 20 directories, 100 files \u5176\u4e2d + BOOT-INT/classes \u76ee\u5f55\u5b58\u653e\u5e94\u7528\u7f16\u8bd1\u540e\u7684class\u6587\u4ef6 + BOOT-INF/lib \u76ee\u5f55\u5b58\u653e\u5e94\u7528\u4f9d\u8d56\u7684jar\u5305 + META-INF \u76ee\u5f55\u5b58\u653e\u5e94\u7528\u76f8\u5173\u7684\u5143\u4fe1\u606f\uff0c\u6bd4\u5982 MANIFEST.MF \u6587\u4ef6 + org \u76ee\u5f55\u5b58\u653eSpring Boot\u6846\u67b6\u76f8\u5173\u7684class\u6587\u4ef6 \u89e3\u538b\u7f29 first-application-by-gui-0.0.1-SNAPSHOT.jar.original \u6587\u4ef6\u5e76\u6bd4\u8f83\u4e8c\u8005\u76ee\u5f55\u5dee\u5f02\uff1a $ unzip first-application-by-gui-0.0.1-SNAPSHOT.jar.original -d original Archive: first-application-by-gui-0.0.1-SNAPSHOT.jar.original inflating: original/META-INF/MANIFEST.MF creating: original/deep/ creating: original/deep/in/ creating: original/deep/in/spring/ creating: original/deep/in/spring/boot/ creating: original/META-INF/maven/ creating: original/META-INF/maven/deep-in-spring-boot/ creating: original/META-INF/maven/deep-in-spring-boot/first-application-by-gui/ inflating: original/deep/in/spring/boot/FirstApplicationByGuiApplication.class inflating: original/application.properties inflating: original/META-INF/maven/deep-in-spring-boot/first-application-by-gui/pom.xml inflating: original/META-INF/maven/deep-in-spring-boot/first-application-by-gui/pom.properties $ tree original/ original/ \u251c\u2500\u2500 META-INF \u2502 \u251c\u2500\u2500 MANIFEST.MF \u2502 \u2514\u2500\u2500 maven \u2502 \u2514\u2500\u2500 deep-in-spring-boot \u2502 \u2514\u2500\u2500 first-application-by-gui \u2502 \u251c\u2500\u2500 pom.properties \u2502 \u2514\u2500\u2500 pom.xml \u251c\u2500\u2500 application.properties \u2514\u2500\u2500 deep \u2514\u2500\u2500 in \u2514\u2500\u2500 spring \u2514\u2500\u2500 boot \u2514\u2500\u2500 FirstApplicationByGuiApplication.class 8 directories, 5 files \u9664\u4e86 META-INF \u76ee\u5f55\uff0c\u5176\u4f59\u5747\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u5c06class\u6587\u4ef6\u548c application.properties \u653e\u5230\u4e86 BOOT-INF/classes \u4e0b\uff0c\u5c06\u6240\u6709\u4f9d\u8d56\u7684jar\u5305\u90fd\u653e\u5230\u4e86 BOOT-INF/lib \u4e0b\u3002\u8fd9\u548c\u4f20\u7edfJava Web\u9879\u76ee\u662f\u7c7b\u4f3c\u7684\uff0c\u6240\u6709class\u6587\u4ef6\u653e\u5728 WEB-INF/classes \u4e0b\uff0c\u800c\u6240\u6709\u4f9d\u8d56\u5728 WEB-INF/lib \u4e0b\u3002 5. JAR\u6267\u884c\u6a21\u5757 spring-boot-loader \u00b6 \u53ef\u6267\u884cJAR\u5305\u88ab java -jar \u547d\u4ee4\u6267\u884c\u65f6\uff0c\u5176\u5e76\u4e0d\u80fd\u611f\u77e5jar\u6587\u4ef6\u662f\u5426\u662fSpring Boot\u63d2\u4ef6\u6253\u5305\u800c\u6765\uff0c\u6267\u884c\u6309\u7167\u6807\u51c6JAR\u6587\u4ef6\u6765\u8fdb\u884c\u3002 Java\u6807\u51c6\u53c2\u8003\uff1a https://docs.oracle.com/javase/8/docs/technotes/tools/windows/java.html If the -jar option is specified, its argument is the name of the JAR file containing class and resource files for the application. The startup class must be indicated by the Main-Class manifest header in its source code. \u4e5f\u5c31\u662f MANIFEST.MF \u6587\u4ef6\u5fc5\u987b\u5728 META-INF \u76ee\u5f55\u4e0b\uff0c\u67e5\u770b\u8be5\u6587\u4ef6: $ cd temp $ cat META-INF/MANIFEST.MF Manifest-Version: 1.0 Spring-Boot-Classpath-Index: BOOT-INF/classpath.idx Implementation-Title: first-application-by-gui Implementation-Version: 0.0.1-SNAPSHOT Start-Class: deep.in.spring.boot.FirstApplicationByGuiApplication Spring-Boot-Classes: BOOT-INF/classes/ Spring-Boot-Lib: BOOT-INF/lib/ Build-Jdk-Spec: 1.8 Spring-Boot-Version: 2.3.2.RELEASE Created-By: Maven Jar Plugin 3.2.0 Main-Class: org.springframework.boot.loader.JarLauncher \u53d1\u73b0 Main-Class \u5c5e\u6027\u4e3a org.springframework.boot.loader.JarLauncher \uff0c\u800c\u9879\u76ee\u7684\u5f15\u5bfc\u7c7b\u5728 Start-Class \u5c5e\u6027\u4e2d\uff0c\u53c2\u8003\u5b98\u65b9\u6587\u6863\u4ecb\u7ecd\uff1a You need to specify an appropriate Launcher as the Main-Class attribute of META-INF/MANIFEST.MF. The actual class that you want to launch (that is, the class that contains a main method) should be specified in the Start-Class attribute. The following example shows a typical MANIFEST.MF for an executable jar file: Main-Class: org.springframework.boot.loader.JarLauncher Start-Class: com.mycompany.project.MyApplication For a war file, it would be as follows: Main-Class: org.springframework.boot.loader.WarLauncher Start-Class: com.mycompany.project.MyApplication \u53ef\u4ee5\u770b\u5230\uff0cJAR\u548cWAR\u5bf9\u5e94\u4e86\u4e0d\u540c\u7684 Launcher \u5b9e\u73b0. \u56e0\u4e3a org.springframework.boot.loader.JarLauncher \u5e76\u975e\u9879\u76ee\u4e2d\u7684\u6587\u4ef6\uff0c\u90a3\u4e48\u5b83\u662f\u7531 spring-boot-maven-plugin \u63d2\u4ef6\u5728\u6253\u5305\u65f6\u5f15\u5165\u7684\uff0c\u4e3a\u4e86\u7814\u7a76\uff0c\u5148\u53bb\u67e5\u627e\u5b83\u7684\u6240\u5c5e\uff0c\u5728 https://search.maven.org/ \u4e2d\uff0c\u53ef\u4ee5\u76f4\u63a5\u6309\u7c7b\u5168\u540d\u641c\u7d22\uff0c\u627e\u5230GAV\u4fe1\u606f <dependency> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-loader </artifactId> <version> 2.3.2.RELEASE </version> </dependency> \u65e2\u7136 org.springframework.boot.loader.JarLauncher \u662f MANIFEAST.MF \u5b9a\u4e49\u7684\u4e3b\u5f15\u5bfc\u7c7b\uff0c\u90a3\u4e48\u76f4\u63a5\u8fd0\u884c\u8be5\u6587\u4ef6\u4e5f\u80fd\u542f\u52a8\u9879\u76ee\uff1a $ java org.springframework.boot.loader.JarLauncher . ____ _ __ _ _ /\\\\ / ___'_ __ _ _(_)_ __ __ _ \\ \\ \\ \\ ( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| | ) ) ) ) ' |____| .__|_| |_|_| |_\\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: (v2.3.2.RELEASE) 2020-08-02 19:53:47.440 INFO 4807 --- [ main] d.i.s.b.FirstApplicationByGuiApplication : Starting FirstApplicationByGuiApplication v0.0.1-SNAPSHOT on nanleis-MacBook-Pro.local with PID 4807 (/Users/nanlei/Dev/Workspace/first-application-by-gui/target/temp/BOOT-INF/classes started by nanlei in /Users/nanlei/Dev/Workspace/first-application-by-gui/target/temp) 2020-08-02 19:53:47.442 INFO 4807 --- [ main] d.i.s.b.FirstApplicationByGuiApplication : No active profile set, falling back to default profiles: default 2020-08-02 19:53:48.060 INFO 4807 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat initialized with port(s): 8080 (http) 2020-08-02 19:53:48.069 INFO 4807 --- [ main] o.apache.catalina.core.StandardService : Starting service [Tomcat] 2020-08-02 19:53:48.069 INFO 4807 --- [ main] org.apache.catalina.core.StandardEngine : Starting Servlet engine: [Apache Tomcat/9.0.37] 2020-08-02 19:53:48.122 INFO 4807 --- [ main] o.a.c.c.C.[Tomcat].[localhost].[/] : Initializing Spring embedded WebApplicationContext 2020-08-02 19:53:48.123 INFO 4807 --- [ main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 645 ms 2020-08-02 19:53:48.286 INFO 4807 --- [ main] o.s.s.concurrent.ThreadPoolTaskExecutor : Initializing ExecutorService 'applicationTaskExecutor' 2020-08-02 19:53:48.439 INFO 4807 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat started on port(s): 8080 (http) with context path '' 2020-08-02 19:53:48.448 INFO 4807 --- [ main] d.i.s.b.FirstApplicationByGuiApplication : Started FirstApplicationByGuiApplication in 1.288 seconds (JVM running for 1.585) \u4ece\u8f93\u51fa\u4e2d\u4e5f\u80fd\u770b\u5230 deep.in.spring.boot.FirstApplicationByGuiApplication \u88ab JarLauncher \u88c5\u8f7d\u5e76\u6267\u884c\uff0c\u4e5f\u5c31\u662f META-INF/MANIFEST.MF \u4e2d\u7684 Start-Class \u88ab JarLauncher \u6267\u884c\u3002\u82e5\u76f4\u63a5\u4f7f\u7528java\u547d\u4ee4\u6267\u884c deep.in.spring.boot.FirstApplicationByGuiApplication \uff1a $ cd BOOT-INF/classes $ java deep.in.spring.boot.FirstApplicationByGuiApplication Exception in thread \"main\" java.lang.NoClassDefFoundError: org/springframework/boot/SpringApplication at deep.in.spring.boot.FirstApplicationByGuiApplication.main(FirstApplicationByGuiApplication.java:10) Caused by: java.lang.ClassNotFoundException: org.springframework.boot.SpringApplication at java.net.URLClassLoader.findClass(URLClassLoader.java:382) at java.lang.ClassLoader.loadClass(ClassLoader.java:418) at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:355) at java.lang.ClassLoader.loadClass(ClassLoader.java:351) ... 1 more \u63d0\u793a\u627e\u4e0d\u5230\u7c7b org.springframework.boot.SpringApplication \uff0c\u8fd9\u662f\u7531\u4e8ejava\u547d\u4ee4\u6ca1\u6709\u6307\u5b9a classpath \uff0c\u52a0\u4e0a classpath \u53c2\u6570\u4e4b\u540e\uff0c\u4e5f\u80fd\u542f\u52a8\u7a0b\u5e8f\uff1a $ java -classpath \".:../lib/*\" deep.in.spring.boot.FirstApplicationByGuiApplication 6. JarLauncher\u7684\u5b9e\u73b0\u539f\u7406 \u00b6 \u5728 pom.xml \u4e2d\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9\uff0c\u7528\u4e8e\u6e90\u7801\u5206\u6790\uff1a <!-- spring-boot-loader \u5206\u6790 --> <dependency> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-loader </artifactId> <scope> provided </scope> </dependency> \u4ee5\u4e0b\u5206\u6790\u5747\u57fa\u4e8eorg.springframework.boot:spring-boot-loader:2.3.1.RELEASE \u56e0\u4e3a\u8fd0\u884c\u65f6 spring-boot-loader \u5728JAR\u6587\u4ef6\u4e2d\u5b58\u5728\uff0c\u6240\u4ee5\u8fd9\u91cc scope \u5b9a\u4e3a provided \u3002 \u5728IDEA\u4e2d\u5bf9 spring-boot-loader \u5f00\u542f\u65ad\u70b9\u8c03\u8bd5\uff1a + \u5c06\u9879\u76ee\u6253\u5305 + \u5728IDEA\u7684 Run/Debug Configuration \u4e2d\u65b0\u5efa JAR Application + \u586b\u5199\u76f8\u5173\u4fe1\u606f\uff0c\u5982\u4e0b\u56fe \u5728IDEA\u4e2d\u6309 command+O \u67e5\u627e org.springframework.boot.loader.JarLauncher \uff0c\u5373\u53ef\u4ece main() \u65b9\u6cd5\u5f00\u59cb\u8ddf\u8e2a\u8c03\u8bd5\u3002 JarLauncher \u7ee7\u627f\u81ea org.springframework.boot.loader.Launcher \uff0c\u5173\u7cfb\u5982\u4e0b\u56fe\u6240\u793a\uff1a JarLauncher \u7684 main() \u65b9\u6cd5\u4e3a\uff1a public static void main ( String [] args ) throws Exception { new JarLauncher (). launch ( args ); } Launcher#launch(args) \u5b9e\u73b0\u4e3a\uff1a protected void launch ( String [] args ) throws Exception { if ( ! isExploded ()) { JarFile . registerUrlProtocolHandler (); } ClassLoader classLoader = createClassLoader ( getClassPathArchivesIterator ()); String jarMode = System . getProperty ( \"jarmode\" ); String launchClass = ( jarMode != null && ! jarMode . isEmpty ()) ? JAR_MODE_LAUNCHER : getMainClass (); launch ( args , launchClass , classLoader ); } \u5176\u4e2d JarFile.registerUrlProtocolHandler() \u65b9\u6cd5\u4e3a\uff1a private static final String PROTOCOL_HANDLER = \"java.protocol.handler.pkgs\" ; private static final String HANDLERS_PACKAGE = \"org.springframework.boot.loader\" ; /** * Register a {@literal 'java.protocol.handler.pkgs'} property so that a * {@link URLStreamHandler} will be located to deal with jar URLs. */ public static void registerUrlProtocolHandler () { String handlers = System . getProperty ( PROTOCOL_HANDLER , \"\" ); System . setProperty ( PROTOCOL_HANDLER , ( \"\" . equals ( handlers ) ? HANDLERS_PACKAGE : handlers + \"|\" + HANDLERS_PACKAGE )); resetCachedUrlHandlers (); } /** * Reset any cached handlers just in case a jar protocol has already been used. We * reset the handler by trying to set a null {@link URLStreamHandlerFactory} which * should have no effect other than clearing the handlers cache. */ private static void resetCachedUrlHandlers () { try { URL . setURLStreamHandlerFactory ( null ); } catch ( Error ex ) { // Ignore } } \u8be5\u65b9\u6cd5\u5c06 org.springframework.boot.loader \u8ffd\u52a0\u5230Java\u7cfb\u7edf\u5c5e\u6027 java.protocol.handler.pkgs \u4e2d\uff0c\u4e5f\u5c31\u662f org.springframework.boot.loader \u5305\u4e0b\u5b58\u5728\u4e00\u4e2a Handler \u7c7b\uff0c\u5373 org.springframework.boot.loader.jar.Handler \uff0c\u5b83\u6269\u5c55\u4e86 URLStreamHandler \uff0c\u8fd9\u662f java.net.URLStreamHandler \u7684\u6269\u5c55\u673a\u5236\u5b9e\u73b0\u7684\uff0c\u7531 URL#getURLStreamHandler(String protocol) \u65b9\u6cd5\u63d0\u4f9b\uff1a private static final String protocolPathProp = \"java.protocol.handler.pkgs\" ; /** * A table of protocol handlers. */ static Hashtable < String , URLStreamHandler > handlers = new Hashtable <> (); private static Object streamHandlerLock = new Object (); /** * Returns the Stream Handler. * @param protocol the protocol to use */ static URLStreamHandler getURLStreamHandler ( String protocol ) { URLStreamHandler handler = handlers . get ( protocol ); if ( handler == null ) { boolean checkedWithFactory = false ; // Use the factory (if any) if ( factory != null ) { handler = factory . createURLStreamHandler ( protocol ); checkedWithFactory = true ; } // Try java protocol handler if ( handler == null ) { String packagePrefixList = null ; packagePrefixList = java . security . AccessController . doPrivileged ( new sun . security . action . GetPropertyAction ( protocolPathProp , \"\" )); if ( packagePrefixList != \"\" ) { packagePrefixList += \"|\" ; } // REMIND: decide whether to allow the \"null\" class prefix // or not. packagePrefixList += \"sun.net.www.protocol\" ; StringTokenizer packagePrefixIter = new StringTokenizer ( packagePrefixList , \"|\" ); while ( handler == null && packagePrefixIter . hasMoreTokens ()) { String packagePrefix = packagePrefixIter . nextToken (). trim (); try { String clsName = packagePrefix + \".\" + protocol + \".Handler\" ; Class <?> cls = null ; try { cls = Class . forName ( clsName ); } catch ( ClassNotFoundException e ) { ClassLoader cl = ClassLoader . getSystemClassLoader (); if ( cl != null ) { cls = cl . loadClass ( clsName ); } } if ( cls != null ) { handler = ( URLStreamHandler ) cls . newInstance (); } } catch ( Exception e ) { // any number of exceptions can get thrown here } } } synchronized ( streamHandlerLock ) { URLStreamHandler handler2 = null ; // Check again with hashtable just in case another // thread created a handler since we last checked handler2 = handlers . get ( protocol ); if ( handler2 != null ) { return handler2 ; } // Check with factory if another thread set a // factory since our last check if ( ! checkedWithFactory && factory != null ) { handler2 = factory . createURLStreamHandler ( protocol ); } if ( handler2 != null ) { // The handler from the factory must be given more // importance. Discard the default handler that // this thread created. handler = handler2 ; } // Insert this handler into the hashtable if ( handler != null ) { handlers . put ( protocol , handler ); } } } return handler ; } \u5176\u4e2dJDK\u5185\u5efa\u534f\u8bae\u653e\u5728 sun.net.www.protocol \u5305\u4e0b\uff0c\u7c7b\u5168\u540d\u6a21\u5f0f\u4e3a sun.net.www.protocol.${protocol}.Handler \uff0c ${protocol} \u4e3a\u534f\u8bae\u540d\uff0c\u5e38\u89c1\u534f\u8bae\u6709\uff1a FILE : sun.net.www.protocol.file.Handler JAR : sun.net.www.prorocol.jar.Handler HTTP : sun.net.www.prorocol.http.Handler HTTPS : sun.net.www.prorocol.https.Handler FTP : sun.net.www.prorocol.ftp.Handler \u56de\u5230 org.springframework.boot.loader.jar.Handler \u4e2d\uff0c\u6309\u7167\u7c7b\u540d\u6a21\u5f0f\uff0c\u5b9e\u73b0\u534f\u8bae\u4e3aJAR\uff0c\u8986\u76d6\u4e86JDK\u7684\u5185\u5efa\u5b9e\u73b0\uff0c\u56e0\u4e3aSpring Boot\u7684FAT JAR\u5305\u542b\u4e86\u4f20\u7edf\u7684java JAR\u8d44\u6e90\uff0c\u8fd8\u5305\u542b\u4e86\u4f9d\u8d56\u7684JAR\u6587\u4ef6\uff0c\u5b83\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u5e94\u7528\u5f52\u6863\u6587\u4ef6\uff0c\u5f53\u4f7f\u7528 java -jar \u547d\u4ee4\u6765\u5f15\u5bfc\u65f6\uff0c\u5185\u90e8\u7684JAR\u6587\u4ef6\u65e0\u6cd5\u88ab\u5185\u5efa\u7684 sun.net.www.prorocol.jar.Handler \u5f53\u4f5c classpath \uff0c\u6240\u4ee5\u9700\u8981\u66ff\u6362\u5b9e\u73b0\u3002 \u5177\u4f53\u53ef\u4ee5\u53c2\u8003 org.springframework.boot.loader.jar.JarURLConnection#get(URL url, JarFile jarFile) \u65b9\u6cd5\u548c org.springframework.boot.loader.jar.JarFile \u7c7b\u3002 Launcher#launch(args) \u65b9\u6cd5\u7684\u7b2c\u4e8c\u6b65\u4e3a createClassLoader(getClassPathArchivesIterator()) \uff0c\u5176\u4e2d getClassPathArchivesIterator() \u65b9\u6cd5\u7531 ExecutableArchiveLauncher \u63d0\u4f9b\uff1a @Override protected Iterator < Archive > getClassPathArchivesIterator () throws Exception { Archive . EntryFilter searchFilter = this :: isSearchCandidate ; Iterator < Archive > archives = this . archive . getNestedArchives ( searchFilter , ( entry ) -> isNestedArchive ( entry ) && ! isEntryIndexed ( entry )); if ( isPostProcessingClassPathArchives ()) { archives = applyClassPathArchivePostProcessing ( archives ); } return archives ; } \u800c isNestedArchive(Archive.Entry entry) \u65b9\u6cd5\u5219\u7531\u5b50\u7c7b JarLauncher \u6216 WarLauncher \u63d0\u4f9b\uff0c\u5728 JarLauncher \u4e2d\uff1a static final EntryFilter NESTED_ARCHIVE_ENTRY_FILTER = ( entry ) -> { if ( entry . isDirectory ()) { return entry . getName (). equals ( \"BOOT-INF/classes/\" ); } return entry . getName (). startsWith ( \"BOOT-INF/lib/\" ); }; @Override protected boolean isNestedArchive ( Archive . Entry entry ) { return NESTED_ARCHIVE_ENTRY_FILTER . matches ( entry ); } \u4e5f\u5c31\u662f\u8fc7\u6ee4 Archive.Entry \u6240\u5339\u914d\u7684\u540d\u79f0\u662f BOOT-INF/classes/ \u8fd8\u662f BOOT-INF/lib/ \u524d\u7f00\uff0c\u800c getClassPathArchivesIterator() \u65b9\u6cd5\u8fd4\u56de\u7ed3\u679c\u8fd8\u662f\u53d6\u51b3\u4e8e archive \u5c5e\u6027\u7684\u5185\u5bb9\uff1a public ExecutableArchiveLauncher () { try { this . archive = createArchive (); this . classPathIndex = getClassPathIndex ( this . archive ); } catch ( Exception ex ) { throw new IllegalStateException ( ex ); } } \u6b64\u5904 archive \u6e90\u4e8e\u7236\u7c7b Launcher \u7684 createArchive() \u65b9\u6cd5\uff1a protected final Archive createArchive () throws Exception { ProtectionDomain protectionDomain = getClass (). getProtectionDomain (); CodeSource codeSource = protectionDomain . getCodeSource (); URI location = ( codeSource != null ) ? codeSource . getLocation (). toURI () : null ; String path = ( location != null ) ? location . getSchemeSpecificPart () : null ; if ( path == null ) { throw new IllegalStateException ( \"Unable to determine code source archive\" ); } File root = new File ( path ); if ( ! root . exists ()) { throw new IllegalStateException ( \"Unable to determine code source archive from \" + root ); } return ( root . isDirectory () ? new ExplodedArchive ( root ) : new JarFileArchive ( root )); } \u8fd9\u91cc\u4e3b\u8981\u901a\u8fc7 Launcher \u6240\u5728\u7684\u5a92\u4ecb\uff0c\u5224\u65ad\u662f JarFileArchive \u8fd8\u662f ExplodedArchive (\u89e3\u538b\u76ee\u5f55)\uff0c\u56e0\u4e3a\u8be5\u65b9\u6cd5\u662f final \u7c7b\u578b\uff0c\u6240\u4ee5\u5b50\u7c7b JarLauncher \u6216 WarLauncher \u5747\u7ee7\u627f\u8be5\u5b9e\u73b0\u3002 \u518d\u5f80\u540e\u5c31\u662f\u6839\u636e\u83b7\u53d6\u5230\u7684archives\u53bb\u521b\u5efa ClassLoader \uff0c\u5728 ExecutableArchiveLauncher \u4e2d\uff1a @Override protected ClassLoader createClassLoader ( Iterator < Archive > archives ) throws Exception { List < URL > urls = new ArrayList <> ( guessClassPathSize ()); while ( archives . hasNext ()) { urls . add ( archives . next (). getUrl ()); } if ( this . classPathIndex != null ) { urls . addAll ( this . classPathIndex . getUrls ()); } return createClassLoader ( urls . toArray ( new URL [ 0 ] )); } \u6700\u540e\u8c03\u7528 Launcher \u4e2d\u7684 createClassLoader(URL[] urls) \u65b9\u6cd5\u521b\u5efa ClassLoader \uff1a protected ClassLoader createClassLoader ( URL [] urls ) throws Exception { return new LaunchedURLClassLoader ( isExploded (), getArchive (), urls , getClass (). getClassLoader ()); } \u4e4b\u540e\u786e\u5b9a launchClass \u7684\u5185\u5bb9\uff0c\u5c31\u662f\u4ece MANIFEST.MF \u4e2d\u83b7\u53d6 Start-Class \u7684\u5185\u5bb9\uff0c\u5728 ExecutableArchiveLauncher \u4e2d\uff1a private static final String START_CLASS_ATTRIBUTE = \"Start-Class\" ; @Override protected String getMainClass () throws Exception { Manifest manifest = this . archive . getManifest (); String mainClass = null ; if ( manifest != null ) { mainClass = manifest . getMainAttributes (). getValue ( START_CLASS_ATTRIBUTE ); } if ( mainClass == null ) { throw new IllegalStateException ( \"No 'Start-Class' manifest entry specified in \" + this ); } return mainClass ; } \u7d27\u63a5\u7740\u8c03\u7528\u5b9e\u9645\u7684\u5f15\u5bfc\u7c7b launch(String[] args, String launchClass, ClassLoader classLoader) protected void launch ( String [] args , String launchClass , ClassLoader classLoader ) throws Exception { Thread . currentThread (). setContextClassLoader ( classLoader ); createMainMethodRunner ( launchClass , args , classLoader ). run (); } protected MainMethodRunner createMainMethodRunner ( String mainClass , String [] args , ClassLoader classLoader ) { return new MainMethodRunner ( mainClass , args ); } \u5b9e\u9645\u6267\u884c\u7684\u65b9\u6cd5\u4e3a MainMethodRunner#run() \uff1a public class MainMethodRunner { private final String mainClassName ; private final String [] args ; public MainMethodRunner ( String mainClass , String [] args ) { this . mainClassName = mainClass ; this . args = ( args != null ) ? args . clone () : null ; } public void run () throws Exception { Class <?> mainClass = Class . forName ( this . mainClassName , false , Thread . currentThread (). getContextClassLoader ()); Method mainMethod = mainClass . getDeclaredMethod ( \"main\" , String [] . class ); mainMethod . setAccessible ( true ); mainMethod . invoke ( null , new Object [] { this . args }); } } \u6700\u540e\u5c06 mainClass \u4e2d\u7684 main(String[]) \u65b9\u6cd5\u6309\u9759\u6001\u65b9\u6cd5\u8c03\u7528\uff0c\u6700\u7ec8 JarLauncher \u662f\u5728\u540c\u8fdb\u7a0b\u5185\u8c03\u7528 Start-Class \u7684 main(String[]) \u65b9\u6cd5\uff0c\u5e76\u4e14\u5728\u8fd9\u4e4b\u524d\u51c6\u5907\u597dClass Path\u3002 7. WarLauncher\u7684\u5dee\u5f02 \u00b6 \u548c JarLauncher \u5dee\u5f02\u4e0d\u5927\uff0c\u4e8c\u8005\u90fd\u662f\u7ee7\u627f\u81ea ExecutableArchiveLauncher \uff1a public class WarLauncher extends ExecutableArchiveLauncher { public WarLauncher () { } protected WarLauncher ( Archive archive ) { super ( archive ); } @Override protected boolean isPostProcessingClassPathArchives () { return false ; } @Override protected boolean isSearchCandidate ( Entry entry ) { return entry . getName (). startsWith ( \"WEB-INF/\" ); } @Override public boolean isNestedArchive ( Archive . Entry entry ) { if ( entry . isDirectory ()) { return entry . getName (). equals ( \"WEB-INF/classes/\" ); } return entry . getName (). startsWith ( \"WEB-INF/lib/\" ) || entry . getName (). startsWith ( \"WEB-INF/lib-provided/\" ); } public static void main ( String [] args ) throws Exception { new WarLauncher (). launch ( args ); } } \u4e3b\u8981\u533a\u522b\u5728\u4e8e\u548cJAR\u7684Class Path\u4e0d\u540c\uff0c WEB-INF/classes/ \u548c WEB-INF/lib/ \u662f\u4f20\u7edfServlet\u5e94\u7528\u7684Class Path\u8def\u5f84\uff0c WEB-INF/lib-provided/ \u662fSpring Boot\u7684 WarLauncher \u5b9a\u5236\u5b9e\u73b0\u3002 \u5c06 pom.xml \u7684 <packaging> \u5143\u7d20\u6539\u4e3a war \uff1a <packaging> war </packaging> \u518d\u6b21\u4f7f\u7528Maven\u8fdb\u884c\u6253\u5305\uff1a $ mvn clean package [INFO] Scanning for projects... [INFO] [INFO] ---------< deep-in-spring-boot:first-spring-boot-application >---------- [INFO] Building first-spring-boot-application 1.0.0-SNAPSHOT [INFO] --------------------------------[ war ]--------------------------------- [INFO] [INFO] --- maven-clean-plugin:3.1.0:clean (default-clean) @ first-spring-boot-application --- [INFO] Deleting /Users/nanlei/Dev/Workspace/first-spring-boot-application/target [INFO] [INFO] --- maven-resources-plugin:3.1.0:resources (default-resources) @ first-spring-boot-application --- [INFO] Using 'UTF-8' encoding to copy filtered resources. [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/main/resources [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/main/resources [INFO] [INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ first-spring-boot-application --- [INFO] Changes detected - recompiling the module! [INFO] Compiling 1 source file to /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/classes [INFO] [INFO] --- maven-resources-plugin:3.1.0:testResources (default-testResources) @ first-spring-boot-application --- [INFO] Using 'UTF-8' encoding to copy filtered resources. [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/test/resources [INFO] [INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ first-spring-boot-application --- [INFO] Changes detected - recompiling the module! [INFO] Compiling 1 source file to /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/test-classes [INFO] [INFO] --- maven-surefire-plugin:2.22.2:test (default-test) @ first-spring-boot-application --- [INFO] [INFO] ------------------------------------------------------- [INFO] T E S T S [INFO] ------------------------------------------------------- [INFO] Running deep.in.spring.boot.AppTest [INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s - in deep.in.spring.boot.AppTest [INFO] [INFO] Results: [INFO] [INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0 [INFO] [INFO] [INFO] --- maven-war-plugin:3.2.3:war (default-war) @ first-spring-boot-application --- [INFO] Packaging webapp [INFO] Assembling webapp [first-spring-boot-application] in [/Users/nanlei/Dev/Workspace/first-spring-boot-application/target/first-spring-boot-application-1.0.0-SNAPSHOT] [INFO] Processing war project [INFO] Webapp assembled in [102 msecs] [INFO] Building war: /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/first-spring-boot-application-1.0.0-SNAPSHOT.war [INFO] [INFO] --- spring-boot-maven-plugin:2.3.1.RELEASE:repackage (repackage) @ first-spring-boot-application --- [INFO] Replacing main artifact with repackaged archive [INFO] ------------------------------------------------------------------------ [INFO] BUILD SUCCESS [INFO] ------------------------------------------------------------------------ [INFO] Total time: 3.457 s [INFO] Finished at: 2020-08-04T00:23:52+08:00 [INFO] ------------------------------------------------------------------------ \u5207\u6362\u5230 target \u76ee\u5f55\uff0c\u5c06 first-spring-boot-application-1.0.0-SNAPSHOT.war \u89e3\u538b\u7f29\u5230temp\u76ee\u5f55\u4e0b\uff1a $ cd target $ unzip first-spring-boot-application-1.0.0-SNAPSHOT.war -d temp Archive: first-spring-boot-application-1.0.0-SNAPSHOT.war creating: temp/META-INF/ inflating: temp/META-INF/MANIFEST.MF creating: temp/org/ creating: temp/org/springframework/ creating: temp/org/springframework/boot/ creating: temp/org/springframework/boot/loader/ inflating: temp/org/springframework/boot/loader/ClassPathIndexFile.class (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) inflating: temp/org/springframework/boot/loader/util/SystemPropertyUtils.class creating: temp/WEB-INF/ creating: temp/WEB-INF/classes/ creating: temp/WEB-INF/classes/deep/ creating: temp/WEB-INF/classes/deep/in/ creating: temp/WEB-INF/classes/deep/in/spring/ creating: temp/WEB-INF/classes/deep/in/spring/boot/ creating: temp/WEB-INF/lib/ inflating: temp/WEB-INF/classes/deep/in/spring/boot/App.class extracting: temp/WEB-INF/lib/jackson-datatype-jsr310-2.11.0.jar (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) extracting: temp/WEB-INF/lib/snakeyaml-1.26.jar creating: temp/META-INF/maven/ creating: temp/META-INF/maven/deep-in-spring-boot/ creating: temp/META-INF/maven/deep-in-spring-boot/first-spring-boot-application/ inflating: temp/META-INF/maven/deep-in-spring-boot/first-spring-boot-application/pom.xml inflating: temp/META-INF/maven/deep-in-spring-boot/first-spring-boot-application/pom.properties extracting: temp/WEB-INF/lib/log4j-to-slf4j-2.13.3.jar extracting: temp/WEB-INF/lib/spring-context-5.2.7.RELEASE.jar extracting: temp/WEB-INF/lib/spring-core-5.2.7.RELEASE.jar extracting: temp/WEB-INF/lib/jul-to-slf4j-1.7.30.jar extracting: temp/WEB-INF/lib/spring-boot-starter-2.3.1.RELEASE.jar extracting: temp/WEB-INF/lib/spring-webmvc-5.2.7.RELEASE.jar creating: temp/WEB-INF/lib-provided/ extracting: temp/WEB-INF/lib-provided/spring-boot-loader-2.3.1.RELEASE.jar \u4f7f\u7528tree\u89c2\u5bdf\u76ee\u5f55\u7ed3\u6784\uff1a $ cd temp $ tree . \u251c\u2500\u2500 META-INF \u2502 \u251c\u2500\u2500 MANIFEST.MF \u2502 \u2514\u2500\u2500 maven \u2502 \u2514\u2500\u2500 deep-in-spring-boot \u2502 \u2514\u2500\u2500 first-spring-boot-application \u2502 \u251c\u2500\u2500 pom.properties \u2502 \u2514\u2500\u2500 pom.xml \u251c\u2500\u2500 WEB-INF \u2502 \u251c\u2500\u2500 classes \u2502 \u2502 \u2514\u2500\u2500 deep \u2502 \u2502 \u2514\u2500\u2500 in \u2502 \u2502 \u2514\u2500\u2500 spring \u2502 \u2502 \u2514\u2500\u2500 boot \u2502 \u2502 \u2514\u2500\u2500 App.class \u2502 \u251c\u2500\u2500 lib \u2502 \u2502 \u251c\u2500\u2500 jackson-annotations-2.11.0.jar \u2502 \u2502 \u251c\u2500\u2500 (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) \u2502 \u2502 \u2514\u2500\u2500 tomcat-embed-websocket-9.0.36.jar \u2502 \u2514\u2500\u2500 lib-provided \u2502 \u2514\u2500\u2500 spring-boot-loader-2.3.1.RELEASE.jar \u2514\u2500\u2500 org \u2514\u2500\u2500 springframework \u2514\u2500\u2500 boot \u2514\u2500\u2500 loader \u251c\u2500\u2500 ClassPathIndexFile.class \u251c\u2500\u2500 ExecutableArchiveLauncher.class \u251c\u2500\u2500 JarLauncher.class \u251c\u2500\u2500 (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) \u251c\u2500\u2500 WarLauncher.class \u251c\u2500\u2500 (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) 21 directories, 99 files \u76f8\u6bd4JAR\u7684\u89e3\u538b\u76ee\u5f55\uff0cWAR\u589e\u52a0\u4e86 /WEB-INF/lib-provided/ \uff0c\u5e76\u4e14\u8be5\u76ee\u5f55\u4e0b\u4ec5\u6709\u4e00\u4e2aJAR\u6587\u4ef6\uff0c\u5c31\u662f spring-boot-loader-2.3.1.RELEASE.jar \uff0c\u4e5f\u5c31\u662f\u8be5\u76ee\u5f55\u4e0b\u5b58\u653e\u4e86 scope \u4e3a provided \u7684JAR\u6587\u4ef6\u3002 \u56e0\u4e3a\u4f20\u7edf Servlet \u9879\u76ee\u5e76\u4e0d\u9700\u8981\u8fd9\u4e2a\u76ee\u5f55\uff0c\u90a3\u4e48 /WEB-INF/lib-provided/ \u4e2d\u7684JAR\u5c06\u88ab Servlet \u5bb9\u5668\u5ffd\u7565\uff0c\u53c8\u6bd4\u5982Servlet API\uff0c\u8be5API\u7531\u5bb9\u5668\u63d0\u4f9b\uff0c\u4f46\u7f16\u7801\u65f6\u9700\u8981\u3002\u8fd9\u6837\u8bbe\u8ba1\u7684\u597d\u5904\u5728\u4e8eWAR\u6587\u4ef6\u80fd\u591f\u5728 Servlet \u5bb9\u5668\u4e2d\u517c\u5bb9\u8fd0\u884c\u3002 \u67e5\u770b META-INF/MANIFEST.MF \u7684\u5185\u5bb9\uff1a $ cat META-INF/MANIFEST.MF Manifest-Version: 1.0 Implementation-Title: first-spring-boot-application Implementation-Version: 1.0.0-SNAPSHOT Start-Class: deep.in.spring.boot.App Spring-Boot-Classes: WEB-INF/classes/ Spring-Boot-Lib: WEB-INF/lib/ Build-Jdk-Spec: 1.8 Spring-Boot-Version: 2.3.1.RELEASE Created-By: Maven Archiver 3.4.0 Implementation-Vendor: Pivotal Software, Inc. Main-Class: org.springframework.boot.loader.WarLauncher \u66f4\u6539\u4e3a war \u65b9\u5f0f\u6253\u5305\u540e\uff0c Main-Class \u5c31\u662f org.springframework.boot.loader.WarLauncher \u4e86\uff0c\u800c Start-Class \u4ecd\u7136\u4e0d\u53d8\u3002\u65e2\u7136\u662f WarLauncher \u4e3a\u4e3b\u5f15\u5bfc\u7c7b\uff0c\u90a3\u4e48\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528 java -jar \u547d\u4ee4\u6765\u542f\u52a8\uff1a $ java -jar first-spring-boot-application-1.0.0-SNAPSHOT.war . ____ _ __ _ _ /\\\\ / ___'_ __ _ _(_)_ __ __ _ \\ \\ \\ \\ ( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| | ) ) ) ) ' |____| .__|_| |_|_| |_\\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: (v2.3.1.RELEASE) 2020-08-04 00:34:25.529 INFO 35990 --- [ main] deep.in.spring.boot.App : Starting App v1.0.0-SNAPSHOT on nanleis-MacBook-Pro.local with PID 35990 (/Users/nanlei/Dev/Workspace/first-spring-boot-application/target/first-spring-boot-application-1.0.0-SNAPSHOT.war started by nanlei in /Users/nanlei/Dev/Workspace/first-spring-boot-application/target) 2020-08-04 00:34:25.532 INFO 35990 --- [ main] deep.in.spring.boot.App : No active profile set, falling back to default profiles: default 2020-08-04 00:34:26.576 INFO 35990 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat initialized with port(s): 8080 (http) 2020-08-04 00:34:26.589 INFO 35990 --- [ main] o.apache.catalina.core.StandardService : Starting service [Tomcat] 2020-08-04 00:34:26.589 INFO 35990 --- [ main] org.apache.catalina.core.StandardEngine : Starting Servlet engine: [Apache Tomcat/9.0.36] 2020-08-04 00:34:27.039 INFO 35990 --- [ main] o.a.c.c.C.[Tomcat].[localhost].[/] : Initializing Spring embedded WebApplicationContext 2020-08-04 00:34:27.040 INFO 35990 --- [ main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1449 ms 2020-08-04 00:34:27.220 INFO 35990 --- [ main] o.s.s.concurrent.ThreadPoolTaskExecutor : Initializing ExecutorService 'applicationTaskExecutor' 2020-08-04 00:34:27.473 INFO 35990 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat started on port(s): 8080 (http) with context path '' 2020-08-04 00:34:27.487 INFO 35990 --- [ main] deep.in.spring.boot.App : Started App in 2.373 seconds (JVM running for 2.815) \u7531\u6b64\u53ef\u89c1\uff0c\u6253\u5305WAR\u6587\u4ef6\u662f\u4e00\u79cd\u517c\u5bb9\u63aa\u65bd\uff0c\u65e2\u80fd\u88ab WarLauncher \u542f\u52a8\uff0c\u4e5f\u80fd\u517c\u5bb9 Servlet \u5bb9\u5668\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c JarLauncher \u548c WarLauncher \u5e76\u65e0\u672c\u8d28\u5dee\u522b\u3002","title":"Standalone Application"},{"location":"SpringBoot/01-spring-boot-application/#1-maven","text":"$ mvn archetype:generate -DgroupId=deep-in-spring-boot -DartifactId=first-spring-boot-application -Dversion=1.0.0-SNAPSHOT -DinteractiveMode=false -Dpackage=deep.in.spring.boot \u7c7b\u4f3c\u7ed3\u679c\uff1a [INFO] Scanning for projects... ([INFO] [INFO] ------------------< org.apache.maven:standalone-pom >------------------- [INFO] Building Maven Stub Project (No POM) 1 [INFO] --------------------------------[ pom ]--------------------------------- [INFO] [INFO] >>> maven-archetype-plugin:3.2.0:generate (default-cli) > generate-sources @ standalone-pom >>> [INFO] [INFO] <<< maven-archetype-plugin:3.2.0:generate (default-cli) < generate-sources @ standalone-pom <<< [INFO] [INFO] ) [INFO] --- maven-archetype-plugin:3.2.0:generate (default-cli) @ standalone-pom --- [INFO] Generating project in Batch mode [WARNING] No archetype found in remote catalog. Defaulting to internal catalog [INFO] No archetype defined. Using maven-archetype-quickstart (org.apache.maven.archetypes:maven-archetype-quickstart:1.0) [INFO] ---------------------------------------------------------------------------- [INFO] Using following parameters for creating project from Old (1.x) Archetype: maven-archetype-quickstart:1.0 [INFO] ---------------------------------------------------------------------------- [INFO] Parameter: basedir, Value: /Users/nanlei/Dev/Workspace [INFO] Parameter: package, Value: deep.in.spring.boot [INFO] Parameter: groupId, Value: deep-in-spring-boot [INFO] Parameter: artifactId, Value: first-spring-boot-application [INFO] Parameter: packageName, Value: deep.in.spring.boot [INFO] Parameter: version, Value: 1.0.0-SNAPSHOT [INFO] project created from Old (1.x) Archetype in dir: /Users/nanlei/Dev/Workspace/first-spring-boot-application [INFO] ------------------------------------------------------------------------ [INFO] BUILD SUCCESS [INFO] ------------------------------------------------------------------------ [INFO] Total time: 1.475 s [INFO] Finished at: 2020-08-01T23:51:37+08:00 archetype \u662fMaven\u63d2\u4ef6 maven-archetype-plugin \u7684\u7b80\u79f0 \u63d2\u4ef6\u76ee\u6807\uff1a archetype:generate \u63d2\u4ef6\u53c2\u6570\uff1aGAV\u4fe1\u606f groupId \uff0c artifactId \uff0c version \u548c\u5305\u540d package \u4ea4\u4e92\u5f0f\u53c2\u6570\uff1a interactiveMode \u4e3a false \uff0c\u4f7f\u7528\u9759\u9ed8\u65b9\u5f0f \u67e5\u770b\u9879\u76ee\u7ed3\u6784\uff1a $ cd first-spring-boot-application/ $ ls -ls total 8 8 -rw-r--r-- 1 nanlei staff 692 Aug 1 23:51 pom.xml 0 drwxr-xr-x 4 nanlei staff 128 Aug 1 23:51 src \u5b89\u88c5tree\u7ec4\u4ef6\u5e76\u518d\u6b21\u67e5\u770b\uff1a $ brew install tree ==> Downloading https://mirrors.aliyun.com/homebrew/homebrew-bottles/bottles/tree-1.8.0.catalina.bottle.tar. ######################################################################## 100.0% ==> Pouring tree-1.8.0.catalina.bottle.tar.gz \ud83c\udf7a /usr/local/Cellar/tree/1.8.0: 8 files, 121.1KB $ tree . \u251c\u2500\u2500 pom.xml \u2514\u2500\u2500 src \u251c\u2500\u2500 main \u2502 \u2514\u2500\u2500 java \u2502 \u2514\u2500\u2500 deep \u2502 \u2514\u2500\u2500 in \u2502 \u2514\u2500\u2500 spring \u2502 \u2514\u2500\u2500 boot \u2502 \u2514\u2500\u2500 App.java \u2514\u2500\u2500 test \u2514\u2500\u2500 java \u2514\u2500\u2500 deep \u2514\u2500\u2500 in \u2514\u2500\u2500 spring \u2514\u2500\u2500 boot \u2514\u2500\u2500 AppTest.java 13 directories, 3 files App.java \u662f\u5f15\u5bfc\u7c7b\uff0c AppTest.java \u662f\u5355\u5143\u6d4b\u8bd5\u7c7b \u5728 pom.xml \u4e2d\uff0c archetype \u63d2\u4ef6\u6dfb\u52a0\u4e86 junit \u7684\u4f9d\u8d56 \u5728 pom.xml \u4e2d\u6dfb\u52a0Spring Boot\u7684web\u4f9d\u8d56\uff1a <dependency> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-starter-web </artifactId> <version> 2.3.1.RELEASE </version> </dependency> \u67e5\u770b\u9879\u76ee dependency \u6811\u7684\u53d8\u5316\uff1a $ mvn dependency:tree -Dincludes=org.springframework* [INFO] Scanning for projects... [INFO] [INFO] ---------< deep-in-spring-boot:first-spring-boot-application >---------- [INFO] Building first-spring-boot-application 1.0.0-SNAPSHOT [INFO] --------------------------------[ jar ]--------------------------------- [INFO] [INFO] --- maven-dependency-plugin:2.8:tree (default-cli) @ first-spring-boot-application --- [INFO] deep-in-spring-boot:first-spring-boot-application:jar:1.0.0-SNAPSHOT [INFO] \\- org.springframework.boot:spring-boot-starter-web:jar:2.3.1.RELEASE:compile [INFO] +- org.springframework.boot:spring-boot-starter:jar:2.3.1.RELEASE:compile [INFO] | +- org.springframework.boot:spring-boot:jar:2.3.1.RELEASE:compile [INFO] | +- org.springframework.boot:spring-boot-autoconfigure:jar:2.3.1.RELEASE:compile [INFO] | +- org.springframework.boot:spring-boot-starter-logging:jar:2.3.1.RELEASE:compile [INFO] | \\- org.springframework:spring-core:jar:5.2.7.RELEASE:compile [INFO] | \\- org.springframework:spring-jcl:jar:5.2.7.RELEASE:compile [INFO] +- org.springframework.boot:spring-boot-starter-json:jar:2.3.1.RELEASE:compile [INFO] +- org.springframework.boot:spring-boot-starter-tomcat:jar:2.3.1.RELEASE:compile [INFO] +- org.springframework:spring-web:jar:5.2.7.RELEASE:compile [INFO] | \\- org.springframework:spring-beans:jar:5.2.7.RELEASE:compile [INFO] \\- org.springframework:spring-webmvc:jar:5.2.7.RELEASE:compile [INFO] +- org.springframework:spring-aop:jar:5.2.7.RELEASE:compile [INFO] +- org.springframework:spring-context:jar:5.2.7.RELEASE:compile [INFO] \\- org.springframework:spring-expression:jar:5.2.7.RELEASE:compile [INFO] ------------------------------------------------------------------------ [INFO] BUILD SUCCESS [INFO] ------------------------------------------------------------------------ [INFO] Total time: 0.802 s [INFO] Finished at: 2020-08-02T00:45:55+08:00 [INFO] ------------------------------------------------------------------------ \u7f16\u5199 App.java \u4ee3\u7801\uff1a @RestController @SpringBootApplication public class App { @RequestMapping ( \"/\" ) public String index () { return \"Welcome to Spring Boot!\" ; } public static void main ( String [] args ) { SpringApplication . run ( App . class , args ); } } \u4f7f\u7528Maven\u63d2\u4ef6\u65b9\u5f0f mvn spring-boot:run \u8fd0\u884c\u9879\u76ee\uff1a $ mvn spring-boot:run [INFO] Scanning for projects... Downloading from aliyun-maven: http://maven.aliyun.com/nexus/content/groups/public/org/apache/maven/plugins/maven-metadata.xml Downloading from aliyun-maven: http://maven.aliyun.com/nexus/content/groups/public/org/codehaus/mojo/maven-metadata.xml Downloaded from aliyun-maven: http://maven.aliyun.com/nexus/content/groups/public/org/apache/maven/plugins/maven-metadata.xml (9.9 kB at 4.4 kB/s) Downloaded from aliyun-maven: http://maven.aliyun.com/nexus/content/groups/public/org/codehaus/mojo/maven-metadata.xml (21 kB at 8.7 kB/s) [INFO] ------------------------------------------------------------------------ [INFO] BUILD FAILURE [INFO] ------------------------------------------------------------------------ [INFO] Total time: 2.835 s [INFO] Finished at: 2020-08-02T01:00:07+08:00 [INFO] ------------------------------------------------------------------------ [ERROR] No plugin found for prefix 'spring-boot' in the current project and in the plugin groups [org.apache.maven.plugins, org.codehaus.mojo] available from the repositories [local (/Users/nanlei/.m2/repository), aliyun-maven (http://maven.aliyun.com/nexus/content/groups/public/)] -> [Help 1] [ERROR] [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch. [ERROR] Re-run Maven using the -X switch to enable full debug logging. [ERROR] [ERROR] For more information about the errors and possible solutions, please read the following articles: [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/NoPluginFoundForPrefixException \u67e5\u770b\u5b98\u65b9\u6587\u6863 https://docs.spring.io/spring-boot/docs/current/reference \u6709\u5982\u4e0b\u5185\u5bb9\uff1a 2.4.4. Running the Example At this point, your application should work. Since you used the spring-boot-starter-parent POM, you have a useful run goal that you can use to start the application. Type mvn spring-boot:run from the root project directory to start the application. \u5728 pom.xml \u4e2d\u6dfb\u52a0 spring-boot-starter-parent \uff1a <parent> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-starter-parent </artifactId> <version> 2.3.1.RELEASE </version> </parent> \u518d\u6b21\u8fd0\u884c\uff1a $ mvn spring-boot:run [INFO] Scanning for projects... [INFO] [INFO] ---------< deep-in-spring-boot:first-spring-boot-application >---------- [INFO] Building first-spring-boot-application 1.0.0-SNAPSHOT [INFO] --------------------------------[ jar ]--------------------------------- [INFO] [INFO] >>> spring-boot-maven-plugin:2.3.1.RELEASE:run (default-cli) > test-compile @ first-spring-boot-application >>> [INFO] [INFO] --- maven-resources-plugin:3.1.0:resources (default-resources) @ first-spring-boot-application --- [INFO] Using 'UTF-8' encoding to copy filtered resources. [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/main/resources [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/main/resources [INFO] [INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ first-spring-boot-application --- [INFO] Nothing to compile - all classes are up to date [INFO] [INFO] --- maven-resources-plugin:3.1.0:testResources (default-testResources) @ first-spring-boot-application --- [INFO] Using 'UTF-8' encoding to copy filtered resources. [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/test/resources [INFO] [INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ first-spring-boot-application --- [INFO] Nothing to compile - all classes are up to date [INFO] [INFO] <<< spring-boot-maven-plugin:2.3.1.RELEASE:run (default-cli) < test-compile @ first-spring-boot-application <<< [INFO] [INFO] [INFO] --- spring-boot-maven-plugin:2.3.1.RELEASE:run (default-cli) @ first-spring-boot-application --- [INFO] Attaching agents: [] . ____ _ __ _ _ /\\\\ / ___'_ __ _ _(_)_ __ __ _ \\ \\ \\ \\ ( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| | ) ) ) ) ' |____| .__|_| |_|_| |_\\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: (v2.3.1.RELEASE) 2020-08-02 01:13:46.642 INFO 6736 --- [ main] deep.in.spring.boot.App : Starting App on nanleis-MacBook-Pro.local with PID 6736 (/Users/nanlei/Dev/Workspace/first-spring-boot-application/target/classes started by nanlei in /Users/nanlei/Dev/Workspace/first-spring-boot-application) 2020-08-02 01:13:46.644 INFO 6736 --- [ main] deep.in.spring.boot.App : No active profile set, falling back to default profiles: default 2020-08-02 01:13:47.141 INFO 6736 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat initialized with port(s): 8080 (http) 2020-08-02 01:13:47.147 INFO 6736 --- [ main] o.apache.catalina.core.StandardService : Starting service [Tomcat] 2020-08-02 01:13:47.148 INFO 6736 --- [ main] org.apache.catalina.core.StandardEngine : Starting Servlet engine: [Apache Tomcat/9.0.36] 2020-08-02 01:13:47.181 INFO 6736 --- [ main] o.a.c.c.C.[Tomcat].[localhost].[/] : Initializing Spring embedded WebApplicationContext 2020-08-02 01:13:47.181 INFO 6736 --- [ main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 507 ms 2020-08-02 01:13:47.268 INFO 6736 --- [ main] o.s.s.concurrent.ThreadPoolTaskExecutor : Initializing ExecutorService 'applicationTaskExecutor' 2020-08-02 01:13:47.352 INFO 6736 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat started on port(s): 8080 (http) with context path '' 2020-08-02 01:13:47.359 INFO 6736 --- [ main] deep.in.spring.boot.App : Started App in 0.917 seconds (JVM running for 1.155) \u68c0\u67e5HTTP\u670d\u52a1\u548c\u6240\u5199\u4ee3\u7801\uff1a $ curl http://127.0.0.1:8080/ Welcome to Spring Boot","title":"1. \u4f7f\u7528Maven\u547d\u4ee4\u884c\u6784\u5efa\u9879\u76ee"},{"location":"SpringBoot/01-spring-boot-application/#2-spring-boot","text":"https://start.spring.io/ \u62f7\u8d1d\u751f\u6210\u597d\u7684zip\u5305\u5230\u9879\u76ee\u76ee\u5f55\uff1a $ cp ~/Downloads/first-application-by-gui.zip . \u89e3\u538b\u7f29\u8be5\u6587\u4ef6\uff1a $ unzip first-application-by-gui.zip Archive: first-application-by-gui.zip creating: first-application-by-gui/ creating: first-application-by-gui/.mvn/ creating: first-application-by-gui/.mvn/wrapper/ inflating: first-application-by-gui/.mvn/wrapper/maven-wrapper.properties inflating: first-application-by-gui/.mvn/wrapper/MavenWrapperDownloader.java inflating: first-application-by-gui/.mvn/wrapper/maven-wrapper.jar inflating: first-application-by-gui/mvnw inflating: first-application-by-gui/.gitignore inflating: first-application-by-gui/HELP.md inflating: first-application-by-gui/mvnw.cmd creating: first-application-by-gui/src/ creating: first-application-by-gui/src/main/ creating: first-application-by-gui/src/main/resources/ creating: first-application-by-gui/src/main/resources/templates/ inflating: first-application-by-gui/src/main/resources/application.properties creating: first-application-by-gui/src/main/resources/static/ creating: first-application-by-gui/src/main/java/ creating: first-application-by-gui/src/main/java/deep/ creating: first-application-by-gui/src/main/java/deep/in/ creating: first-application-by-gui/src/main/java/deep/in/spring/ creating: first-application-by-gui/src/main/java/deep/in/spring/boot/ inflating: first-application-by-gui/src/main/java/deep/in/spring/boot/FirstApplicationByGuiApplication.java creating: first-application-by-gui/src/test/ creating: first-application-by-gui/src/test/java/ creating: first-application-by-gui/src/test/java/deep/ creating: first-application-by-gui/src/test/java/deep/in/ creating: first-application-by-gui/src/test/java/deep/in/spring/ creating: first-application-by-gui/src/test/java/deep/in/spring/boot/ inflating: first-application-by-gui/src/test/java/deep/in/spring/boot/FirstApplicationByGuiApplicationTests.java inflating: first-application-by-gui/pom.xml \u4f7f\u7528 tree \u547d\u4ee4\u67e5\u770b\uff1a $ tree -a first-application-by-gui first-application-by-gui \u251c\u2500\u2500 .gitignore \u251c\u2500\u2500 .mvn \u2502 \u2514\u2500\u2500 wrapper \u2502 \u251c\u2500\u2500 MavenWrapperDownloader.java \u2502 \u251c\u2500\u2500 maven-wrapper.jar \u2502 \u2514\u2500\u2500 maven-wrapper.properties \u251c\u2500\u2500 HELP.md \u251c\u2500\u2500 mvnw \u251c\u2500\u2500 mvnw.cmd \u251c\u2500\u2500 pom.xml \u2514\u2500\u2500 src \u251c\u2500\u2500 main \u2502 \u251c\u2500\u2500 java \u2502 \u2502 \u2514\u2500\u2500 deep \u2502 \u2502 \u2514\u2500\u2500 in \u2502 \u2502 \u2514\u2500\u2500 spring \u2502 \u2502 \u2514\u2500\u2500 boot \u2502 \u2502 \u2514\u2500\u2500 FirstApplicationByGuiApplication.java \u2502 \u2514\u2500\u2500 resources \u2502 \u251c\u2500\u2500 application.properties \u2502 \u251c\u2500\u2500 static \u2502 \u2514\u2500\u2500 templates \u2514\u2500\u2500 test \u2514\u2500\u2500 java \u2514\u2500\u2500 deep \u2514\u2500\u2500 in \u2514\u2500\u2500 spring \u2514\u2500\u2500 boot \u2514\u2500\u2500 FirstApplicationByGuiApplicationTests.java 18 directories, 11 files .gitignore \u6587\u4ef6\u5b9a\u4e49\u4e86\u5e38\u89c1\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u7248\u672c\u63a7\u5236\u5ffd\u7565\u540d\u5355\uff0c\u6bd4\u5982\uff1a HELP.md target/ !.mvn/wrapper/maven-wrapper.jar !**/src/main/**/target/ !**/src/test/**/target/ ### STS ### .apt_generated .classpath .factorypath .project .settings .springBeans .sts4-cache ### IntelliJ IDEA ### .idea *.iws *.iml *.ipr ### NetBeans ### /nbproject/private/ /nbbuild/ /dist/ /nbdist/ /.nb-gradle/ build/ !**/src/main/**/build/ !**/src/test/**/build/ ### VS Code ### .vscode/ Maven Wrapper\u6587\u4ef6\u5305\u542b .mvn \u76ee\u5f55\u3001 mvnw \u548c mvnw.cmd \u6587\u4ef6\uff0c \u53c2\u8003\uff1a https://github.com/takari/maven-wrapper \u53ef\u4ee5\u4e0d\u5b89\u88c5Maven\u800c\u76f4\u63a5\u4f7f\u7528\uff0c\u6bd4\u5982\uff1a Normally you instruct users to install a specific version of Apache Maven, put it on the PATH and then run the mvn command like the following: mvn clean install But now, with a Maven Wrapper setup, you can instruct users to run wrapper scripts: ./mvnw clean install application.properties \u6587\u4ef6 \u662fSpring Boot\u9ed8\u8ba4\u7684\u5e94\u7528\u5916\u90e8\u914d\u7f6e\u6587\u4ef6\uff0c\u5176\u914d\u7f6e\u5c5e\u6027\u53ef\u4ee5\u5f71\u54cd\u5e94\u7528\u7a0b\u5e8f\u7684\u884c\u4e3a\u3002 FirstApplicationByGuiApplicationTests.java \u6587\u4ef6 \u662fSpring Boot\u5355\u5143\u6d4b\u8bd5\u7684\u6a21\u7248JUnit\u6587\u4ef6\uff0c\u5176\u8def\u5f84\u548c\u5bf9\u5e94\u7684\u5f15\u5bfc\u6587\u4ef6 FirstApplicationByGuiApplication.java \u5bf9\u5e94\u3002 \u542f\u52a8\u9879\u76ee\u5e76\u8bbf\u95ee\uff1a $ curl http://127.0.0.1:8080/ {\"timestamp\":\"2020-08-02T08:57:15.817+00:00\",\"status\":404,\"error\":\"Not Found\",\"message\":\"\",\"path\":\"/\"} \u56e0\u9879\u76ee\u6ca1\u6709\u7f16\u5199\u9ed8\u8ba4\u670d\u52a1\u800c\u62a5404\u9519\u8bef \u5b89\u88c5 jsonpp \u67e5\u770bJSON\u54cd\u5e94\uff1a $ brew install jsonpp ==> Downloading https://mirrors.aliyun.com/homebrew/homebrew-bottles/bottles/jsonpp-1.3.0_1.catalina.bottle.tar.gz ######################################################################## 100.0% ==> Pouring jsonpp-1.3.0_1.catalina.bottle.tar.gz \ud83c\udf7a /usr/local/Cellar/jsonpp/1.3.0_1: 5 files, 2.4MB \u518d\u6b21\u8bbf\u95ee\uff1a $ curl http://127.0.0.1:8080 | jsonpp % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 102 0 102 0 0 20400 0 --:--:-- --:--:-- --:--:-- 20400 { \"timestamp\": \"2020-08-02T09:03:24.359+00:00\", \"status\": 404, \"error\": \"Not Found\", \"message\": \"\", \"path\": \"/\" }","title":"2. \u56fe\u5f62\u5316\u6784\u5efaSpring Boot\u5e94\u7528"},{"location":"SpringBoot/01-spring-boot-application/#3-spring-bootjar","text":"2.4.5. Creating an Executable Jar We finish our example by creating a completely self-contained executable jar file that we could run in production. Executable jars (sometimes called \u201cfat jars\u201d) are archives containing your compiled classes along with all of the jar dependencies that your code needs to run. \u53ef\u6267\u884c\u7684JAR\u53c8\u79f0\u4e3a\u201cfat jars\u201d To create an executable jar, we need to add the spring-boot-maven-plugin to our pom.xml . To do so, insert the following lines just below the dependencies section: \u6839\u636e\u5b98\u65b9\u6587\u6863\u89e3\u91ca\uff0c\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9\u5230 pom.xml \u4e2d\uff1a <build> <plugins> <plugin> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-maven-plugin </artifactId> </plugin> </plugins> </build> \u7136\u540e\u6267\u884c mvn package \u547d\u4ee4\uff1a $ mvn package [INFO] Scanning for projects... [INFO] [INFO] ------------< deep-in-spring-boot:first-application-by-gui >------------ [INFO] Building first-application-by-gui 0.0.1-SNAPSHOT [INFO] --------------------------------[ jar ]--------------------------------- (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) [INFO] ------------------------------------------------------- [INFO] T E S T S [INFO] ------------------------------------------------------- (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) . ____ _ __ _ _ /\\\\ / ___'_ __ _ _(_)_ __ __ _ \\ \\ \\ \\ ( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| | ) ) ) ) ' |____| .__|_| |_|_| |_\\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: (v2.3.2.RELEASE) 2020-08-02 17:15:06.025 INFO 4060 --- [ main] .b.FirstApplicationByGuiApplicationTests : Starting FirstApplicationByGuiApplicationTests on nanleis-MacBook-Pro.local with PID 4060 (started by nanlei in /Users/nanlei/Dev/Workspace/first-application-by-gui) 2020-08-02 17:15:06.026 INFO 4060 --- [ main] .b.FirstApplicationByGuiApplicationTests : No active profile set, falling back to default profiles: default 2020-08-02 17:15:06.709 INFO 4060 --- [ main] o.s.s.concurrent.ThreadPoolTaskExecutor : Initializing ExecutorService 'applicationTaskExecutor' 2020-08-02 17:15:06.958 INFO 4060 --- [ main] .b.FirstApplicationByGuiApplicationTests : Started FirstApplicationByGuiApplicationTests in 1.075 seconds (JVM running for 1.706) [INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.508 s - in deep.in.spring.boot.FirstApplicationByGuiApplicationTests 2020-08-02 17:15:07.127 INFO 4060 --- [extShutdownHook] o.s.s.concurrent.ThreadPoolTaskExecutor : Shutting down ExecutorService 'applicationTaskExecutor' [INFO] [INFO] Results: [INFO] [INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0 [INFO] [INFO] [INFO] --- maven-jar-plugin:3.2.0:jar (default-jar) @ first-application-by-gui --- [INFO] Building jar: /Users/nanlei/Dev/Workspace/first-application-by-gui/target/first-application-by-gui-0.0.1-SNAPSHOT.jar [INFO] [INFO] --- spring-boot-maven-plugin:2.3.2.RELEASE:repackage (repackage) @ first-application-by-gui --- [INFO] Replacing main artifact with repackaged archive [INFO] ------------------------------------------------------------------------ [INFO] BUILD SUCCESS [INFO] ------------------------------------------------------------------------ [INFO] Total time: 3.535 s [INFO] Finished at: 2020-08-02T17:15:07+08:00 [INFO] ------------------------------------------------------------------------ \u6700\u7ec8\u751f\u6210\u7684 first-application-by-gui-0.0.1-SNAPSHOT.jar \u5c31\u5728 target \u76ee\u5f55\u4e0b\uff0c\u4f7f\u7528 java -jar \u547d\u4ee4\u8fd0\u884cJAR\uff1a $ java -jar target/first-application-by-gui-0.0.1-SNAPSHOT.jar . ____ _ __ _ _ /\\\\ / ___'_ __ _ _(_)_ __ __ _ \\ \\ \\ \\ ( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| | ) ) ) ) ' |____| .__|_| |_|_| |_\\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: (v2.3.2.RELEASE) 2020-08-02 17:24:33.034 INFO 4219 --- [ main] d.i.s.b.FirstApplicationByGuiApplication : Starting FirstApplicationByGuiApplication v0.0.1-SNAPSHOT on nanleis-MacBook-Pro.local with PID 4219 (/Users/nanlei/Dev/Workspace/first-application-by-gui/target/first-application-by-gui-0.0.1-SNAPSHOT.jar started by nanlei in /Users/nanlei/Dev/Workspace/first-application-by-gui) 2020-08-02 17:24:33.036 INFO 4219 --- [ main] d.i.s.b.FirstApplicationByGuiApplication : No active profile set, falling back to default profiles: default 2020-08-02 17:24:33.800 INFO 4219 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat initialized with port(s): 8080 (http) 2020-08-02 17:24:33.809 INFO 4219 --- [ main] o.apache.catalina.core.StandardService : Starting service [Tomcat] 2020-08-02 17:24:33.810 INFO 4219 --- [ main] org.apache.catalina.core.StandardEngine : Starting Servlet engine: [Apache Tomcat/9.0.37] 2020-08-02 17:24:33.865 INFO 4219 --- [ main] o.a.c.c.C.[Tomcat].[localhost].[/] : Initializing Spring embedded WebApplicationContext 2020-08-02 17:24:33.865 INFO 4219 --- [ main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 785 ms 2020-08-02 17:24:34.031 INFO 4219 --- [ main] o.s.s.concurrent.ThreadPoolTaskExecutor : Initializing ExecutorService 'applicationTaskExecutor' 2020-08-02 17:24:34.221 INFO 4219 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat started on port(s): 8080 (http) with context path '' 2020-08-02 17:24:34.231 INFO 4219 --- [ main] d.i.s.b.FirstApplicationByGuiApplication : Started FirstApplicationByGuiApplication in 1.523 seconds (JVM running for 1.894) java -jar \u65b9\u5f0f\u548c mvn spring-boot:run \u65b9\u5f0f\u57fa\u672c\u65e0\u5f02","title":"3. \u521b\u5efaSpring Boot\u5e94\u7528\u7a0b\u5e8f\u7684\u53ef\u6267\u884cJAR"},{"location":"SpringBoot/01-spring-boot-application/#4-spring-bootjar","text":"\u5728 target \u76ee\u5f55\u4e0b\u6267\u884c tree -h $ tree -h . \u251c\u2500\u2500 [ 128] classes \u2502 \u251c\u2500\u2500 [ 1] application.properties \u2502 \u2514\u2500\u2500 [ 96] deep \u2502 \u2514\u2500\u2500 [ 96] in \u2502 \u2514\u2500\u2500 [ 96] spring \u2502 \u2514\u2500\u2500 [ 96] boot \u2502 \u2514\u2500\u2500 [ 790] FirstApplicationByGuiApplication.class \u251c\u2500\u2500 [ 16M] first-application-by-gui-0.0.1-SNAPSHOT.jar \u251c\u2500\u2500 [3.0K] first-application-by-gui-0.0.1-SNAPSHOT.jar.original \u251c\u2500\u2500 [ 96] generated-sources \u2502 \u2514\u2500\u2500 [ 64] annotations \u251c\u2500\u2500 [ 96] generated-test-sources \u2502 \u2514\u2500\u2500 [ 64] test-annotations \u251c\u2500\u2500 [ 96] maven-archiver \u2502 \u2514\u2500\u2500 [ 87] pom.properties \u251c\u2500\u2500 [ 96] maven-status \u2502 \u2514\u2500\u2500 [ 128] maven-compiler-plugin \u2502 \u251c\u2500\u2500 [ 96] compile \u2502 \u2502 \u2514\u2500\u2500 [ 128] default-compile \u2502 \u2502 \u251c\u2500\u2500 [ 59] createdFiles.lst \u2502 \u2502 \u2514\u2500\u2500 [ 125] inputFiles.lst \u2502 \u2514\u2500\u2500 [ 96] testCompile \u2502 \u2514\u2500\u2500 [ 128] default-testCompile \u2502 \u251c\u2500\u2500 [ 64] createdFiles.lst \u2502 \u2514\u2500\u2500 [ 130] inputFiles.lst \u251c\u2500\u2500 [ 128] surefire-reports \u2502 \u251c\u2500\u2500 [ 18K] TEST-deep.in.spring.boot.FirstApplicationByGuiApplicationTests.xml \u2502 \u2514\u2500\u2500 [ 363] deep.in.spring.boot.FirstApplicationByGuiApplicationTests.txt \u2514\u2500\u2500 [ 96] test-classes \u2514\u2500\u2500 [ 96] deep \u2514\u2500\u2500 [ 96] in \u2514\u2500\u2500 [ 96] spring \u2514\u2500\u2500 [ 96] boot \u2514\u2500\u2500 [ 588] FirstApplicationByGuiApplicationTests.class 22 directories, 12 files first-application-by-gui-0.0.1-SNAPSHOT.jar.original \u662f\u672a\u5305\u542b\u7b2c\u4e09\u65b9\u4f9d\u8d56\u7684\u672c\u5730\u8d44\u6e90(\u7f16\u8bd1\u540e\u7684 classes \u76ee\u5f55\u4e0b\u7684\u8d44\u6e90)\uff0c\u6240\u5360\u7a7a\u95f4\u4ec53K\uff0c\u800c\u53ef\u6267\u884cJAR\u7684\u5927\u5c0f\u4e3a16M\u3002 \u89e3\u538b\u7f29 first-application-by-gui-0.0.1-SNAPSHOT.jar \u5230\u4e34\u65f6\u76ee\u5f55temp\u5e76\u67e5\u770b\uff1a $ unzip first-application-by-gui-0.0.1-SNAPSHOT.jar -d temp Archive: first-application-by-gui-0.0.1-SNAPSHOT.jar creating: temp/META-INF/ inflating: temp/META-INF/MANIFEST.MF creating: temp/org/ creating: temp/org/springframework/ creating: temp/org/springframework/boot/ creating: temp/org/springframework/boot/loader/ (\u7701\u7565\u90e8\u5206\u5185\u5bb9) extracting: temp/BOOT-INF/lib/tomcat-embed-websocket-9.0.37.jar extracting: temp/BOOT-INF/lib/spring-web-5.2.8.RELEASE.jar extracting: temp/BOOT-INF/lib/spring-beans-5.2.8.RELEASE.jar extracting: temp/BOOT-INF/lib/spring-webmvc-5.2.8.RELEASE.jar extracting: temp/BOOT-INF/lib/spring-aop-5.2.8.RELEASE.jar extracting: temp/BOOT-INF/lib/spring-context-5.2.8.RELEASE.jar extracting: temp/BOOT-INF/lib/spring-expression-5.2.8.RELEASE.jar extracting: temp/BOOT-INF/lib/slf4j-api-1.7.30.jar extracting: temp/BOOT-INF/lib/spring-core-5.2.8.RELEASE.jar extracting: temp/BOOT-INF/lib/spring-jcl-5.2.8.RELEASE.jar inflating: temp/BOOT-INF/classpath.idx \u67e5\u770btemp\u76ee\u5f55\u7684\u7ed3\u6784\uff1a $ tree temp/ temp/ \u251c\u2500\u2500 BOOT-INF \u2502 \u251c\u2500\u2500 classes \u2502 \u2502 \u251c\u2500\u2500 application.properties \u2502 \u2502 \u2514\u2500\u2500 deep \u2502 \u2502 \u2514\u2500\u2500 in \u2502 \u2502 \u2514\u2500\u2500 spring \u2502 \u2502 \u2514\u2500\u2500 boot \u2502 \u2502 \u2514\u2500\u2500 FirstApplicationByGuiApplication.class \u2502 \u251c\u2500\u2500 classpath.idx \u2502 \u2514\u2500\u2500 lib \u2502 \u251c\u2500\u2500 ... \u2502 \u251c\u2500\u2500 spring-aop-5.2.8.RELEASE.jar \u2502 \u251c\u2500\u2500 spring-beans-5.2.8.RELEASE.jar \u2502 \u251c\u2500\u2500 spring-boot-2.3.2.RELEASE.jar \u2502 \u251c\u2500\u2500 spring-boot-autoconfigure-2.3.2.RELEASE.jar \u2502 \u251c\u2500\u2500 ... \u2502 \u251c\u2500\u2500 tomcat-embed-core-9.0.37.jar \u2502 \u2514\u2500\u2500 tomcat-embed-websocket-9.0.37.jar \u251c\u2500\u2500 META-INF \u2502 \u251c\u2500\u2500 MANIFEST.MF \u2502 \u2514\u2500\u2500 maven \u2502 \u2514\u2500\u2500 deep-in-spring-boot \u2502 \u2514\u2500\u2500 first-application-by-gui \u2502 \u251c\u2500\u2500 pom.properties \u2502 \u2514\u2500\u2500 pom.xml \u2514\u2500\u2500 org \u2514\u2500\u2500 springframework \u2514\u2500\u2500 boot \u2514\u2500\u2500 loader \u251c\u2500\u2500 ClassPathIndexFile.class \u251c\u2500\u2500 ExecutableArchiveLauncher.class \u251c\u2500\u2500 JarLauncher.class \u251c\u2500\u2500 ... 20 directories, 100 files \u5176\u4e2d + BOOT-INT/classes \u76ee\u5f55\u5b58\u653e\u5e94\u7528\u7f16\u8bd1\u540e\u7684class\u6587\u4ef6 + BOOT-INF/lib \u76ee\u5f55\u5b58\u653e\u5e94\u7528\u4f9d\u8d56\u7684jar\u5305 + META-INF \u76ee\u5f55\u5b58\u653e\u5e94\u7528\u76f8\u5173\u7684\u5143\u4fe1\u606f\uff0c\u6bd4\u5982 MANIFEST.MF \u6587\u4ef6 + org \u76ee\u5f55\u5b58\u653eSpring Boot\u6846\u67b6\u76f8\u5173\u7684class\u6587\u4ef6 \u89e3\u538b\u7f29 first-application-by-gui-0.0.1-SNAPSHOT.jar.original \u6587\u4ef6\u5e76\u6bd4\u8f83\u4e8c\u8005\u76ee\u5f55\u5dee\u5f02\uff1a $ unzip first-application-by-gui-0.0.1-SNAPSHOT.jar.original -d original Archive: first-application-by-gui-0.0.1-SNAPSHOT.jar.original inflating: original/META-INF/MANIFEST.MF creating: original/deep/ creating: original/deep/in/ creating: original/deep/in/spring/ creating: original/deep/in/spring/boot/ creating: original/META-INF/maven/ creating: original/META-INF/maven/deep-in-spring-boot/ creating: original/META-INF/maven/deep-in-spring-boot/first-application-by-gui/ inflating: original/deep/in/spring/boot/FirstApplicationByGuiApplication.class inflating: original/application.properties inflating: original/META-INF/maven/deep-in-spring-boot/first-application-by-gui/pom.xml inflating: original/META-INF/maven/deep-in-spring-boot/first-application-by-gui/pom.properties $ tree original/ original/ \u251c\u2500\u2500 META-INF \u2502 \u251c\u2500\u2500 MANIFEST.MF \u2502 \u2514\u2500\u2500 maven \u2502 \u2514\u2500\u2500 deep-in-spring-boot \u2502 \u2514\u2500\u2500 first-application-by-gui \u2502 \u251c\u2500\u2500 pom.properties \u2502 \u2514\u2500\u2500 pom.xml \u251c\u2500\u2500 application.properties \u2514\u2500\u2500 deep \u2514\u2500\u2500 in \u2514\u2500\u2500 spring \u2514\u2500\u2500 boot \u2514\u2500\u2500 FirstApplicationByGuiApplication.class 8 directories, 5 files \u9664\u4e86 META-INF \u76ee\u5f55\uff0c\u5176\u4f59\u5747\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u5c06class\u6587\u4ef6\u548c application.properties \u653e\u5230\u4e86 BOOT-INF/classes \u4e0b\uff0c\u5c06\u6240\u6709\u4f9d\u8d56\u7684jar\u5305\u90fd\u653e\u5230\u4e86 BOOT-INF/lib \u4e0b\u3002\u8fd9\u548c\u4f20\u7edfJava Web\u9879\u76ee\u662f\u7c7b\u4f3c\u7684\uff0c\u6240\u6709class\u6587\u4ef6\u653e\u5728 WEB-INF/classes \u4e0b\uff0c\u800c\u6240\u6709\u4f9d\u8d56\u5728 WEB-INF/lib \u4e0b\u3002","title":"4. Spring Boot\u53ef\u6267\u884cJAR\u8d44\u6e90\u7ed3\u6784"},{"location":"SpringBoot/01-spring-boot-application/#5-jarspring-boot-loader","text":"\u53ef\u6267\u884cJAR\u5305\u88ab java -jar \u547d\u4ee4\u6267\u884c\u65f6\uff0c\u5176\u5e76\u4e0d\u80fd\u611f\u77e5jar\u6587\u4ef6\u662f\u5426\u662fSpring Boot\u63d2\u4ef6\u6253\u5305\u800c\u6765\uff0c\u6267\u884c\u6309\u7167\u6807\u51c6JAR\u6587\u4ef6\u6765\u8fdb\u884c\u3002 Java\u6807\u51c6\u53c2\u8003\uff1a https://docs.oracle.com/javase/8/docs/technotes/tools/windows/java.html If the -jar option is specified, its argument is the name of the JAR file containing class and resource files for the application. The startup class must be indicated by the Main-Class manifest header in its source code. \u4e5f\u5c31\u662f MANIFEST.MF \u6587\u4ef6\u5fc5\u987b\u5728 META-INF \u76ee\u5f55\u4e0b\uff0c\u67e5\u770b\u8be5\u6587\u4ef6: $ cd temp $ cat META-INF/MANIFEST.MF Manifest-Version: 1.0 Spring-Boot-Classpath-Index: BOOT-INF/classpath.idx Implementation-Title: first-application-by-gui Implementation-Version: 0.0.1-SNAPSHOT Start-Class: deep.in.spring.boot.FirstApplicationByGuiApplication Spring-Boot-Classes: BOOT-INF/classes/ Spring-Boot-Lib: BOOT-INF/lib/ Build-Jdk-Spec: 1.8 Spring-Boot-Version: 2.3.2.RELEASE Created-By: Maven Jar Plugin 3.2.0 Main-Class: org.springframework.boot.loader.JarLauncher \u53d1\u73b0 Main-Class \u5c5e\u6027\u4e3a org.springframework.boot.loader.JarLauncher \uff0c\u800c\u9879\u76ee\u7684\u5f15\u5bfc\u7c7b\u5728 Start-Class \u5c5e\u6027\u4e2d\uff0c\u53c2\u8003\u5b98\u65b9\u6587\u6863\u4ecb\u7ecd\uff1a You need to specify an appropriate Launcher as the Main-Class attribute of META-INF/MANIFEST.MF. The actual class that you want to launch (that is, the class that contains a main method) should be specified in the Start-Class attribute. The following example shows a typical MANIFEST.MF for an executable jar file: Main-Class: org.springframework.boot.loader.JarLauncher Start-Class: com.mycompany.project.MyApplication For a war file, it would be as follows: Main-Class: org.springframework.boot.loader.WarLauncher Start-Class: com.mycompany.project.MyApplication \u53ef\u4ee5\u770b\u5230\uff0cJAR\u548cWAR\u5bf9\u5e94\u4e86\u4e0d\u540c\u7684 Launcher \u5b9e\u73b0. \u56e0\u4e3a org.springframework.boot.loader.JarLauncher \u5e76\u975e\u9879\u76ee\u4e2d\u7684\u6587\u4ef6\uff0c\u90a3\u4e48\u5b83\u662f\u7531 spring-boot-maven-plugin \u63d2\u4ef6\u5728\u6253\u5305\u65f6\u5f15\u5165\u7684\uff0c\u4e3a\u4e86\u7814\u7a76\uff0c\u5148\u53bb\u67e5\u627e\u5b83\u7684\u6240\u5c5e\uff0c\u5728 https://search.maven.org/ \u4e2d\uff0c\u53ef\u4ee5\u76f4\u63a5\u6309\u7c7b\u5168\u540d\u641c\u7d22\uff0c\u627e\u5230GAV\u4fe1\u606f <dependency> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-loader </artifactId> <version> 2.3.2.RELEASE </version> </dependency> \u65e2\u7136 org.springframework.boot.loader.JarLauncher \u662f MANIFEAST.MF \u5b9a\u4e49\u7684\u4e3b\u5f15\u5bfc\u7c7b\uff0c\u90a3\u4e48\u76f4\u63a5\u8fd0\u884c\u8be5\u6587\u4ef6\u4e5f\u80fd\u542f\u52a8\u9879\u76ee\uff1a $ java org.springframework.boot.loader.JarLauncher . ____ _ __ _ _ /\\\\ / ___'_ __ _ _(_)_ __ __ _ \\ \\ \\ \\ ( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| | ) ) ) ) ' |____| .__|_| |_|_| |_\\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: (v2.3.2.RELEASE) 2020-08-02 19:53:47.440 INFO 4807 --- [ main] d.i.s.b.FirstApplicationByGuiApplication : Starting FirstApplicationByGuiApplication v0.0.1-SNAPSHOT on nanleis-MacBook-Pro.local with PID 4807 (/Users/nanlei/Dev/Workspace/first-application-by-gui/target/temp/BOOT-INF/classes started by nanlei in /Users/nanlei/Dev/Workspace/first-application-by-gui/target/temp) 2020-08-02 19:53:47.442 INFO 4807 --- [ main] d.i.s.b.FirstApplicationByGuiApplication : No active profile set, falling back to default profiles: default 2020-08-02 19:53:48.060 INFO 4807 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat initialized with port(s): 8080 (http) 2020-08-02 19:53:48.069 INFO 4807 --- [ main] o.apache.catalina.core.StandardService : Starting service [Tomcat] 2020-08-02 19:53:48.069 INFO 4807 --- [ main] org.apache.catalina.core.StandardEngine : Starting Servlet engine: [Apache Tomcat/9.0.37] 2020-08-02 19:53:48.122 INFO 4807 --- [ main] o.a.c.c.C.[Tomcat].[localhost].[/] : Initializing Spring embedded WebApplicationContext 2020-08-02 19:53:48.123 INFO 4807 --- [ main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 645 ms 2020-08-02 19:53:48.286 INFO 4807 --- [ main] o.s.s.concurrent.ThreadPoolTaskExecutor : Initializing ExecutorService 'applicationTaskExecutor' 2020-08-02 19:53:48.439 INFO 4807 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat started on port(s): 8080 (http) with context path '' 2020-08-02 19:53:48.448 INFO 4807 --- [ main] d.i.s.b.FirstApplicationByGuiApplication : Started FirstApplicationByGuiApplication in 1.288 seconds (JVM running for 1.585) \u4ece\u8f93\u51fa\u4e2d\u4e5f\u80fd\u770b\u5230 deep.in.spring.boot.FirstApplicationByGuiApplication \u88ab JarLauncher \u88c5\u8f7d\u5e76\u6267\u884c\uff0c\u4e5f\u5c31\u662f META-INF/MANIFEST.MF \u4e2d\u7684 Start-Class \u88ab JarLauncher \u6267\u884c\u3002\u82e5\u76f4\u63a5\u4f7f\u7528java\u547d\u4ee4\u6267\u884c deep.in.spring.boot.FirstApplicationByGuiApplication \uff1a $ cd BOOT-INF/classes $ java deep.in.spring.boot.FirstApplicationByGuiApplication Exception in thread \"main\" java.lang.NoClassDefFoundError: org/springframework/boot/SpringApplication at deep.in.spring.boot.FirstApplicationByGuiApplication.main(FirstApplicationByGuiApplication.java:10) Caused by: java.lang.ClassNotFoundException: org.springframework.boot.SpringApplication at java.net.URLClassLoader.findClass(URLClassLoader.java:382) at java.lang.ClassLoader.loadClass(ClassLoader.java:418) at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:355) at java.lang.ClassLoader.loadClass(ClassLoader.java:351) ... 1 more \u63d0\u793a\u627e\u4e0d\u5230\u7c7b org.springframework.boot.SpringApplication \uff0c\u8fd9\u662f\u7531\u4e8ejava\u547d\u4ee4\u6ca1\u6709\u6307\u5b9a classpath \uff0c\u52a0\u4e0a classpath \u53c2\u6570\u4e4b\u540e\uff0c\u4e5f\u80fd\u542f\u52a8\u7a0b\u5e8f\uff1a $ java -classpath \".:../lib/*\" deep.in.spring.boot.FirstApplicationByGuiApplication","title":"5. JAR\u6267\u884c\u6a21\u5757spring-boot-loader"},{"location":"SpringBoot/01-spring-boot-application/#6-jarlauncher","text":"\u5728 pom.xml \u4e2d\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9\uff0c\u7528\u4e8e\u6e90\u7801\u5206\u6790\uff1a <!-- spring-boot-loader \u5206\u6790 --> <dependency> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-loader </artifactId> <scope> provided </scope> </dependency> \u4ee5\u4e0b\u5206\u6790\u5747\u57fa\u4e8eorg.springframework.boot:spring-boot-loader:2.3.1.RELEASE \u56e0\u4e3a\u8fd0\u884c\u65f6 spring-boot-loader \u5728JAR\u6587\u4ef6\u4e2d\u5b58\u5728\uff0c\u6240\u4ee5\u8fd9\u91cc scope \u5b9a\u4e3a provided \u3002 \u5728IDEA\u4e2d\u5bf9 spring-boot-loader \u5f00\u542f\u65ad\u70b9\u8c03\u8bd5\uff1a + \u5c06\u9879\u76ee\u6253\u5305 + \u5728IDEA\u7684 Run/Debug Configuration \u4e2d\u65b0\u5efa JAR Application + \u586b\u5199\u76f8\u5173\u4fe1\u606f\uff0c\u5982\u4e0b\u56fe \u5728IDEA\u4e2d\u6309 command+O \u67e5\u627e org.springframework.boot.loader.JarLauncher \uff0c\u5373\u53ef\u4ece main() \u65b9\u6cd5\u5f00\u59cb\u8ddf\u8e2a\u8c03\u8bd5\u3002 JarLauncher \u7ee7\u627f\u81ea org.springframework.boot.loader.Launcher \uff0c\u5173\u7cfb\u5982\u4e0b\u56fe\u6240\u793a\uff1a JarLauncher \u7684 main() \u65b9\u6cd5\u4e3a\uff1a public static void main ( String [] args ) throws Exception { new JarLauncher (). launch ( args ); } Launcher#launch(args) \u5b9e\u73b0\u4e3a\uff1a protected void launch ( String [] args ) throws Exception { if ( ! isExploded ()) { JarFile . registerUrlProtocolHandler (); } ClassLoader classLoader = createClassLoader ( getClassPathArchivesIterator ()); String jarMode = System . getProperty ( \"jarmode\" ); String launchClass = ( jarMode != null && ! jarMode . isEmpty ()) ? JAR_MODE_LAUNCHER : getMainClass (); launch ( args , launchClass , classLoader ); } \u5176\u4e2d JarFile.registerUrlProtocolHandler() \u65b9\u6cd5\u4e3a\uff1a private static final String PROTOCOL_HANDLER = \"java.protocol.handler.pkgs\" ; private static final String HANDLERS_PACKAGE = \"org.springframework.boot.loader\" ; /** * Register a {@literal 'java.protocol.handler.pkgs'} property so that a * {@link URLStreamHandler} will be located to deal with jar URLs. */ public static void registerUrlProtocolHandler () { String handlers = System . getProperty ( PROTOCOL_HANDLER , \"\" ); System . setProperty ( PROTOCOL_HANDLER , ( \"\" . equals ( handlers ) ? HANDLERS_PACKAGE : handlers + \"|\" + HANDLERS_PACKAGE )); resetCachedUrlHandlers (); } /** * Reset any cached handlers just in case a jar protocol has already been used. We * reset the handler by trying to set a null {@link URLStreamHandlerFactory} which * should have no effect other than clearing the handlers cache. */ private static void resetCachedUrlHandlers () { try { URL . setURLStreamHandlerFactory ( null ); } catch ( Error ex ) { // Ignore } } \u8be5\u65b9\u6cd5\u5c06 org.springframework.boot.loader \u8ffd\u52a0\u5230Java\u7cfb\u7edf\u5c5e\u6027 java.protocol.handler.pkgs \u4e2d\uff0c\u4e5f\u5c31\u662f org.springframework.boot.loader \u5305\u4e0b\u5b58\u5728\u4e00\u4e2a Handler \u7c7b\uff0c\u5373 org.springframework.boot.loader.jar.Handler \uff0c\u5b83\u6269\u5c55\u4e86 URLStreamHandler \uff0c\u8fd9\u662f java.net.URLStreamHandler \u7684\u6269\u5c55\u673a\u5236\u5b9e\u73b0\u7684\uff0c\u7531 URL#getURLStreamHandler(String protocol) \u65b9\u6cd5\u63d0\u4f9b\uff1a private static final String protocolPathProp = \"java.protocol.handler.pkgs\" ; /** * A table of protocol handlers. */ static Hashtable < String , URLStreamHandler > handlers = new Hashtable <> (); private static Object streamHandlerLock = new Object (); /** * Returns the Stream Handler. * @param protocol the protocol to use */ static URLStreamHandler getURLStreamHandler ( String protocol ) { URLStreamHandler handler = handlers . get ( protocol ); if ( handler == null ) { boolean checkedWithFactory = false ; // Use the factory (if any) if ( factory != null ) { handler = factory . createURLStreamHandler ( protocol ); checkedWithFactory = true ; } // Try java protocol handler if ( handler == null ) { String packagePrefixList = null ; packagePrefixList = java . security . AccessController . doPrivileged ( new sun . security . action . GetPropertyAction ( protocolPathProp , \"\" )); if ( packagePrefixList != \"\" ) { packagePrefixList += \"|\" ; } // REMIND: decide whether to allow the \"null\" class prefix // or not. packagePrefixList += \"sun.net.www.protocol\" ; StringTokenizer packagePrefixIter = new StringTokenizer ( packagePrefixList , \"|\" ); while ( handler == null && packagePrefixIter . hasMoreTokens ()) { String packagePrefix = packagePrefixIter . nextToken (). trim (); try { String clsName = packagePrefix + \".\" + protocol + \".Handler\" ; Class <?> cls = null ; try { cls = Class . forName ( clsName ); } catch ( ClassNotFoundException e ) { ClassLoader cl = ClassLoader . getSystemClassLoader (); if ( cl != null ) { cls = cl . loadClass ( clsName ); } } if ( cls != null ) { handler = ( URLStreamHandler ) cls . newInstance (); } } catch ( Exception e ) { // any number of exceptions can get thrown here } } } synchronized ( streamHandlerLock ) { URLStreamHandler handler2 = null ; // Check again with hashtable just in case another // thread created a handler since we last checked handler2 = handlers . get ( protocol ); if ( handler2 != null ) { return handler2 ; } // Check with factory if another thread set a // factory since our last check if ( ! checkedWithFactory && factory != null ) { handler2 = factory . createURLStreamHandler ( protocol ); } if ( handler2 != null ) { // The handler from the factory must be given more // importance. Discard the default handler that // this thread created. handler = handler2 ; } // Insert this handler into the hashtable if ( handler != null ) { handlers . put ( protocol , handler ); } } } return handler ; } \u5176\u4e2dJDK\u5185\u5efa\u534f\u8bae\u653e\u5728 sun.net.www.protocol \u5305\u4e0b\uff0c\u7c7b\u5168\u540d\u6a21\u5f0f\u4e3a sun.net.www.protocol.${protocol}.Handler \uff0c ${protocol} \u4e3a\u534f\u8bae\u540d\uff0c\u5e38\u89c1\u534f\u8bae\u6709\uff1a FILE : sun.net.www.protocol.file.Handler JAR : sun.net.www.prorocol.jar.Handler HTTP : sun.net.www.prorocol.http.Handler HTTPS : sun.net.www.prorocol.https.Handler FTP : sun.net.www.prorocol.ftp.Handler \u56de\u5230 org.springframework.boot.loader.jar.Handler \u4e2d\uff0c\u6309\u7167\u7c7b\u540d\u6a21\u5f0f\uff0c\u5b9e\u73b0\u534f\u8bae\u4e3aJAR\uff0c\u8986\u76d6\u4e86JDK\u7684\u5185\u5efa\u5b9e\u73b0\uff0c\u56e0\u4e3aSpring Boot\u7684FAT JAR\u5305\u542b\u4e86\u4f20\u7edf\u7684java JAR\u8d44\u6e90\uff0c\u8fd8\u5305\u542b\u4e86\u4f9d\u8d56\u7684JAR\u6587\u4ef6\uff0c\u5b83\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u5e94\u7528\u5f52\u6863\u6587\u4ef6\uff0c\u5f53\u4f7f\u7528 java -jar \u547d\u4ee4\u6765\u5f15\u5bfc\u65f6\uff0c\u5185\u90e8\u7684JAR\u6587\u4ef6\u65e0\u6cd5\u88ab\u5185\u5efa\u7684 sun.net.www.prorocol.jar.Handler \u5f53\u4f5c classpath \uff0c\u6240\u4ee5\u9700\u8981\u66ff\u6362\u5b9e\u73b0\u3002 \u5177\u4f53\u53ef\u4ee5\u53c2\u8003 org.springframework.boot.loader.jar.JarURLConnection#get(URL url, JarFile jarFile) \u65b9\u6cd5\u548c org.springframework.boot.loader.jar.JarFile \u7c7b\u3002 Launcher#launch(args) \u65b9\u6cd5\u7684\u7b2c\u4e8c\u6b65\u4e3a createClassLoader(getClassPathArchivesIterator()) \uff0c\u5176\u4e2d getClassPathArchivesIterator() \u65b9\u6cd5\u7531 ExecutableArchiveLauncher \u63d0\u4f9b\uff1a @Override protected Iterator < Archive > getClassPathArchivesIterator () throws Exception { Archive . EntryFilter searchFilter = this :: isSearchCandidate ; Iterator < Archive > archives = this . archive . getNestedArchives ( searchFilter , ( entry ) -> isNestedArchive ( entry ) && ! isEntryIndexed ( entry )); if ( isPostProcessingClassPathArchives ()) { archives = applyClassPathArchivePostProcessing ( archives ); } return archives ; } \u800c isNestedArchive(Archive.Entry entry) \u65b9\u6cd5\u5219\u7531\u5b50\u7c7b JarLauncher \u6216 WarLauncher \u63d0\u4f9b\uff0c\u5728 JarLauncher \u4e2d\uff1a static final EntryFilter NESTED_ARCHIVE_ENTRY_FILTER = ( entry ) -> { if ( entry . isDirectory ()) { return entry . getName (). equals ( \"BOOT-INF/classes/\" ); } return entry . getName (). startsWith ( \"BOOT-INF/lib/\" ); }; @Override protected boolean isNestedArchive ( Archive . Entry entry ) { return NESTED_ARCHIVE_ENTRY_FILTER . matches ( entry ); } \u4e5f\u5c31\u662f\u8fc7\u6ee4 Archive.Entry \u6240\u5339\u914d\u7684\u540d\u79f0\u662f BOOT-INF/classes/ \u8fd8\u662f BOOT-INF/lib/ \u524d\u7f00\uff0c\u800c getClassPathArchivesIterator() \u65b9\u6cd5\u8fd4\u56de\u7ed3\u679c\u8fd8\u662f\u53d6\u51b3\u4e8e archive \u5c5e\u6027\u7684\u5185\u5bb9\uff1a public ExecutableArchiveLauncher () { try { this . archive = createArchive (); this . classPathIndex = getClassPathIndex ( this . archive ); } catch ( Exception ex ) { throw new IllegalStateException ( ex ); } } \u6b64\u5904 archive \u6e90\u4e8e\u7236\u7c7b Launcher \u7684 createArchive() \u65b9\u6cd5\uff1a protected final Archive createArchive () throws Exception { ProtectionDomain protectionDomain = getClass (). getProtectionDomain (); CodeSource codeSource = protectionDomain . getCodeSource (); URI location = ( codeSource != null ) ? codeSource . getLocation (). toURI () : null ; String path = ( location != null ) ? location . getSchemeSpecificPart () : null ; if ( path == null ) { throw new IllegalStateException ( \"Unable to determine code source archive\" ); } File root = new File ( path ); if ( ! root . exists ()) { throw new IllegalStateException ( \"Unable to determine code source archive from \" + root ); } return ( root . isDirectory () ? new ExplodedArchive ( root ) : new JarFileArchive ( root )); } \u8fd9\u91cc\u4e3b\u8981\u901a\u8fc7 Launcher \u6240\u5728\u7684\u5a92\u4ecb\uff0c\u5224\u65ad\u662f JarFileArchive \u8fd8\u662f ExplodedArchive (\u89e3\u538b\u76ee\u5f55)\uff0c\u56e0\u4e3a\u8be5\u65b9\u6cd5\u662f final \u7c7b\u578b\uff0c\u6240\u4ee5\u5b50\u7c7b JarLauncher \u6216 WarLauncher \u5747\u7ee7\u627f\u8be5\u5b9e\u73b0\u3002 \u518d\u5f80\u540e\u5c31\u662f\u6839\u636e\u83b7\u53d6\u5230\u7684archives\u53bb\u521b\u5efa ClassLoader \uff0c\u5728 ExecutableArchiveLauncher \u4e2d\uff1a @Override protected ClassLoader createClassLoader ( Iterator < Archive > archives ) throws Exception { List < URL > urls = new ArrayList <> ( guessClassPathSize ()); while ( archives . hasNext ()) { urls . add ( archives . next (). getUrl ()); } if ( this . classPathIndex != null ) { urls . addAll ( this . classPathIndex . getUrls ()); } return createClassLoader ( urls . toArray ( new URL [ 0 ] )); } \u6700\u540e\u8c03\u7528 Launcher \u4e2d\u7684 createClassLoader(URL[] urls) \u65b9\u6cd5\u521b\u5efa ClassLoader \uff1a protected ClassLoader createClassLoader ( URL [] urls ) throws Exception { return new LaunchedURLClassLoader ( isExploded (), getArchive (), urls , getClass (). getClassLoader ()); } \u4e4b\u540e\u786e\u5b9a launchClass \u7684\u5185\u5bb9\uff0c\u5c31\u662f\u4ece MANIFEST.MF \u4e2d\u83b7\u53d6 Start-Class \u7684\u5185\u5bb9\uff0c\u5728 ExecutableArchiveLauncher \u4e2d\uff1a private static final String START_CLASS_ATTRIBUTE = \"Start-Class\" ; @Override protected String getMainClass () throws Exception { Manifest manifest = this . archive . getManifest (); String mainClass = null ; if ( manifest != null ) { mainClass = manifest . getMainAttributes (). getValue ( START_CLASS_ATTRIBUTE ); } if ( mainClass == null ) { throw new IllegalStateException ( \"No 'Start-Class' manifest entry specified in \" + this ); } return mainClass ; } \u7d27\u63a5\u7740\u8c03\u7528\u5b9e\u9645\u7684\u5f15\u5bfc\u7c7b launch(String[] args, String launchClass, ClassLoader classLoader) protected void launch ( String [] args , String launchClass , ClassLoader classLoader ) throws Exception { Thread . currentThread (). setContextClassLoader ( classLoader ); createMainMethodRunner ( launchClass , args , classLoader ). run (); } protected MainMethodRunner createMainMethodRunner ( String mainClass , String [] args , ClassLoader classLoader ) { return new MainMethodRunner ( mainClass , args ); } \u5b9e\u9645\u6267\u884c\u7684\u65b9\u6cd5\u4e3a MainMethodRunner#run() \uff1a public class MainMethodRunner { private final String mainClassName ; private final String [] args ; public MainMethodRunner ( String mainClass , String [] args ) { this . mainClassName = mainClass ; this . args = ( args != null ) ? args . clone () : null ; } public void run () throws Exception { Class <?> mainClass = Class . forName ( this . mainClassName , false , Thread . currentThread (). getContextClassLoader ()); Method mainMethod = mainClass . getDeclaredMethod ( \"main\" , String [] . class ); mainMethod . setAccessible ( true ); mainMethod . invoke ( null , new Object [] { this . args }); } } \u6700\u540e\u5c06 mainClass \u4e2d\u7684 main(String[]) \u65b9\u6cd5\u6309\u9759\u6001\u65b9\u6cd5\u8c03\u7528\uff0c\u6700\u7ec8 JarLauncher \u662f\u5728\u540c\u8fdb\u7a0b\u5185\u8c03\u7528 Start-Class \u7684 main(String[]) \u65b9\u6cd5\uff0c\u5e76\u4e14\u5728\u8fd9\u4e4b\u524d\u51c6\u5907\u597dClass Path\u3002","title":"6. JarLauncher\u7684\u5b9e\u73b0\u539f\u7406"},{"location":"SpringBoot/01-spring-boot-application/#7-warlauncher","text":"\u548c JarLauncher \u5dee\u5f02\u4e0d\u5927\uff0c\u4e8c\u8005\u90fd\u662f\u7ee7\u627f\u81ea ExecutableArchiveLauncher \uff1a public class WarLauncher extends ExecutableArchiveLauncher { public WarLauncher () { } protected WarLauncher ( Archive archive ) { super ( archive ); } @Override protected boolean isPostProcessingClassPathArchives () { return false ; } @Override protected boolean isSearchCandidate ( Entry entry ) { return entry . getName (). startsWith ( \"WEB-INF/\" ); } @Override public boolean isNestedArchive ( Archive . Entry entry ) { if ( entry . isDirectory ()) { return entry . getName (). equals ( \"WEB-INF/classes/\" ); } return entry . getName (). startsWith ( \"WEB-INF/lib/\" ) || entry . getName (). startsWith ( \"WEB-INF/lib-provided/\" ); } public static void main ( String [] args ) throws Exception { new WarLauncher (). launch ( args ); } } \u4e3b\u8981\u533a\u522b\u5728\u4e8e\u548cJAR\u7684Class Path\u4e0d\u540c\uff0c WEB-INF/classes/ \u548c WEB-INF/lib/ \u662f\u4f20\u7edfServlet\u5e94\u7528\u7684Class Path\u8def\u5f84\uff0c WEB-INF/lib-provided/ \u662fSpring Boot\u7684 WarLauncher \u5b9a\u5236\u5b9e\u73b0\u3002 \u5c06 pom.xml \u7684 <packaging> \u5143\u7d20\u6539\u4e3a war \uff1a <packaging> war </packaging> \u518d\u6b21\u4f7f\u7528Maven\u8fdb\u884c\u6253\u5305\uff1a $ mvn clean package [INFO] Scanning for projects... [INFO] [INFO] ---------< deep-in-spring-boot:first-spring-boot-application >---------- [INFO] Building first-spring-boot-application 1.0.0-SNAPSHOT [INFO] --------------------------------[ war ]--------------------------------- [INFO] [INFO] --- maven-clean-plugin:3.1.0:clean (default-clean) @ first-spring-boot-application --- [INFO] Deleting /Users/nanlei/Dev/Workspace/first-spring-boot-application/target [INFO] [INFO] --- maven-resources-plugin:3.1.0:resources (default-resources) @ first-spring-boot-application --- [INFO] Using 'UTF-8' encoding to copy filtered resources. [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/main/resources [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/main/resources [INFO] [INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ first-spring-boot-application --- [INFO] Changes detected - recompiling the module! [INFO] Compiling 1 source file to /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/classes [INFO] [INFO] --- maven-resources-plugin:3.1.0:testResources (default-testResources) @ first-spring-boot-application --- [INFO] Using 'UTF-8' encoding to copy filtered resources. [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/test/resources [INFO] [INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ first-spring-boot-application --- [INFO] Changes detected - recompiling the module! [INFO] Compiling 1 source file to /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/test-classes [INFO] [INFO] --- maven-surefire-plugin:2.22.2:test (default-test) @ first-spring-boot-application --- [INFO] [INFO] ------------------------------------------------------- [INFO] T E S T S [INFO] ------------------------------------------------------- [INFO] Running deep.in.spring.boot.AppTest [INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s - in deep.in.spring.boot.AppTest [INFO] [INFO] Results: [INFO] [INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0 [INFO] [INFO] [INFO] --- maven-war-plugin:3.2.3:war (default-war) @ first-spring-boot-application --- [INFO] Packaging webapp [INFO] Assembling webapp [first-spring-boot-application] in [/Users/nanlei/Dev/Workspace/first-spring-boot-application/target/first-spring-boot-application-1.0.0-SNAPSHOT] [INFO] Processing war project [INFO] Webapp assembled in [102 msecs] [INFO] Building war: /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/first-spring-boot-application-1.0.0-SNAPSHOT.war [INFO] [INFO] --- spring-boot-maven-plugin:2.3.1.RELEASE:repackage (repackage) @ first-spring-boot-application --- [INFO] Replacing main artifact with repackaged archive [INFO] ------------------------------------------------------------------------ [INFO] BUILD SUCCESS [INFO] ------------------------------------------------------------------------ [INFO] Total time: 3.457 s [INFO] Finished at: 2020-08-04T00:23:52+08:00 [INFO] ------------------------------------------------------------------------ \u5207\u6362\u5230 target \u76ee\u5f55\uff0c\u5c06 first-spring-boot-application-1.0.0-SNAPSHOT.war \u89e3\u538b\u7f29\u5230temp\u76ee\u5f55\u4e0b\uff1a $ cd target $ unzip first-spring-boot-application-1.0.0-SNAPSHOT.war -d temp Archive: first-spring-boot-application-1.0.0-SNAPSHOT.war creating: temp/META-INF/ inflating: temp/META-INF/MANIFEST.MF creating: temp/org/ creating: temp/org/springframework/ creating: temp/org/springframework/boot/ creating: temp/org/springframework/boot/loader/ inflating: temp/org/springframework/boot/loader/ClassPathIndexFile.class (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) inflating: temp/org/springframework/boot/loader/util/SystemPropertyUtils.class creating: temp/WEB-INF/ creating: temp/WEB-INF/classes/ creating: temp/WEB-INF/classes/deep/ creating: temp/WEB-INF/classes/deep/in/ creating: temp/WEB-INF/classes/deep/in/spring/ creating: temp/WEB-INF/classes/deep/in/spring/boot/ creating: temp/WEB-INF/lib/ inflating: temp/WEB-INF/classes/deep/in/spring/boot/App.class extracting: temp/WEB-INF/lib/jackson-datatype-jsr310-2.11.0.jar (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) extracting: temp/WEB-INF/lib/snakeyaml-1.26.jar creating: temp/META-INF/maven/ creating: temp/META-INF/maven/deep-in-spring-boot/ creating: temp/META-INF/maven/deep-in-spring-boot/first-spring-boot-application/ inflating: temp/META-INF/maven/deep-in-spring-boot/first-spring-boot-application/pom.xml inflating: temp/META-INF/maven/deep-in-spring-boot/first-spring-boot-application/pom.properties extracting: temp/WEB-INF/lib/log4j-to-slf4j-2.13.3.jar extracting: temp/WEB-INF/lib/spring-context-5.2.7.RELEASE.jar extracting: temp/WEB-INF/lib/spring-core-5.2.7.RELEASE.jar extracting: temp/WEB-INF/lib/jul-to-slf4j-1.7.30.jar extracting: temp/WEB-INF/lib/spring-boot-starter-2.3.1.RELEASE.jar extracting: temp/WEB-INF/lib/spring-webmvc-5.2.7.RELEASE.jar creating: temp/WEB-INF/lib-provided/ extracting: temp/WEB-INF/lib-provided/spring-boot-loader-2.3.1.RELEASE.jar \u4f7f\u7528tree\u89c2\u5bdf\u76ee\u5f55\u7ed3\u6784\uff1a $ cd temp $ tree . \u251c\u2500\u2500 META-INF \u2502 \u251c\u2500\u2500 MANIFEST.MF \u2502 \u2514\u2500\u2500 maven \u2502 \u2514\u2500\u2500 deep-in-spring-boot \u2502 \u2514\u2500\u2500 first-spring-boot-application \u2502 \u251c\u2500\u2500 pom.properties \u2502 \u2514\u2500\u2500 pom.xml \u251c\u2500\u2500 WEB-INF \u2502 \u251c\u2500\u2500 classes \u2502 \u2502 \u2514\u2500\u2500 deep \u2502 \u2502 \u2514\u2500\u2500 in \u2502 \u2502 \u2514\u2500\u2500 spring \u2502 \u2502 \u2514\u2500\u2500 boot \u2502 \u2502 \u2514\u2500\u2500 App.class \u2502 \u251c\u2500\u2500 lib \u2502 \u2502 \u251c\u2500\u2500 jackson-annotations-2.11.0.jar \u2502 \u2502 \u251c\u2500\u2500 (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) \u2502 \u2502 \u2514\u2500\u2500 tomcat-embed-websocket-9.0.36.jar \u2502 \u2514\u2500\u2500 lib-provided \u2502 \u2514\u2500\u2500 spring-boot-loader-2.3.1.RELEASE.jar \u2514\u2500\u2500 org \u2514\u2500\u2500 springframework \u2514\u2500\u2500 boot \u2514\u2500\u2500 loader \u251c\u2500\u2500 ClassPathIndexFile.class \u251c\u2500\u2500 ExecutableArchiveLauncher.class \u251c\u2500\u2500 JarLauncher.class \u251c\u2500\u2500 (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) \u251c\u2500\u2500 WarLauncher.class \u251c\u2500\u2500 (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) 21 directories, 99 files \u76f8\u6bd4JAR\u7684\u89e3\u538b\u76ee\u5f55\uff0cWAR\u589e\u52a0\u4e86 /WEB-INF/lib-provided/ \uff0c\u5e76\u4e14\u8be5\u76ee\u5f55\u4e0b\u4ec5\u6709\u4e00\u4e2aJAR\u6587\u4ef6\uff0c\u5c31\u662f spring-boot-loader-2.3.1.RELEASE.jar \uff0c\u4e5f\u5c31\u662f\u8be5\u76ee\u5f55\u4e0b\u5b58\u653e\u4e86 scope \u4e3a provided \u7684JAR\u6587\u4ef6\u3002 \u56e0\u4e3a\u4f20\u7edf Servlet \u9879\u76ee\u5e76\u4e0d\u9700\u8981\u8fd9\u4e2a\u76ee\u5f55\uff0c\u90a3\u4e48 /WEB-INF/lib-provided/ \u4e2d\u7684JAR\u5c06\u88ab Servlet \u5bb9\u5668\u5ffd\u7565\uff0c\u53c8\u6bd4\u5982Servlet API\uff0c\u8be5API\u7531\u5bb9\u5668\u63d0\u4f9b\uff0c\u4f46\u7f16\u7801\u65f6\u9700\u8981\u3002\u8fd9\u6837\u8bbe\u8ba1\u7684\u597d\u5904\u5728\u4e8eWAR\u6587\u4ef6\u80fd\u591f\u5728 Servlet \u5bb9\u5668\u4e2d\u517c\u5bb9\u8fd0\u884c\u3002 \u67e5\u770b META-INF/MANIFEST.MF \u7684\u5185\u5bb9\uff1a $ cat META-INF/MANIFEST.MF Manifest-Version: 1.0 Implementation-Title: first-spring-boot-application Implementation-Version: 1.0.0-SNAPSHOT Start-Class: deep.in.spring.boot.App Spring-Boot-Classes: WEB-INF/classes/ Spring-Boot-Lib: WEB-INF/lib/ Build-Jdk-Spec: 1.8 Spring-Boot-Version: 2.3.1.RELEASE Created-By: Maven Archiver 3.4.0 Implementation-Vendor: Pivotal Software, Inc. Main-Class: org.springframework.boot.loader.WarLauncher \u66f4\u6539\u4e3a war \u65b9\u5f0f\u6253\u5305\u540e\uff0c Main-Class \u5c31\u662f org.springframework.boot.loader.WarLauncher \u4e86\uff0c\u800c Start-Class \u4ecd\u7136\u4e0d\u53d8\u3002\u65e2\u7136\u662f WarLauncher \u4e3a\u4e3b\u5f15\u5bfc\u7c7b\uff0c\u90a3\u4e48\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528 java -jar \u547d\u4ee4\u6765\u542f\u52a8\uff1a $ java -jar first-spring-boot-application-1.0.0-SNAPSHOT.war . ____ _ __ _ _ /\\\\ / ___'_ __ _ _(_)_ __ __ _ \\ \\ \\ \\ ( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| | ) ) ) ) ' |____| .__|_| |_|_| |_\\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: (v2.3.1.RELEASE) 2020-08-04 00:34:25.529 INFO 35990 --- [ main] deep.in.spring.boot.App : Starting App v1.0.0-SNAPSHOT on nanleis-MacBook-Pro.local with PID 35990 (/Users/nanlei/Dev/Workspace/first-spring-boot-application/target/first-spring-boot-application-1.0.0-SNAPSHOT.war started by nanlei in /Users/nanlei/Dev/Workspace/first-spring-boot-application/target) 2020-08-04 00:34:25.532 INFO 35990 --- [ main] deep.in.spring.boot.App : No active profile set, falling back to default profiles: default 2020-08-04 00:34:26.576 INFO 35990 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat initialized with port(s): 8080 (http) 2020-08-04 00:34:26.589 INFO 35990 --- [ main] o.apache.catalina.core.StandardService : Starting service [Tomcat] 2020-08-04 00:34:26.589 INFO 35990 --- [ main] org.apache.catalina.core.StandardEngine : Starting Servlet engine: [Apache Tomcat/9.0.36] 2020-08-04 00:34:27.039 INFO 35990 --- [ main] o.a.c.c.C.[Tomcat].[localhost].[/] : Initializing Spring embedded WebApplicationContext 2020-08-04 00:34:27.040 INFO 35990 --- [ main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1449 ms 2020-08-04 00:34:27.220 INFO 35990 --- [ main] o.s.s.concurrent.ThreadPoolTaskExecutor : Initializing ExecutorService 'applicationTaskExecutor' 2020-08-04 00:34:27.473 INFO 35990 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat started on port(s): 8080 (http) with context path '' 2020-08-04 00:34:27.487 INFO 35990 --- [ main] deep.in.spring.boot.App : Started App in 2.373 seconds (JVM running for 2.815) \u7531\u6b64\u53ef\u89c1\uff0c\u6253\u5305WAR\u6587\u4ef6\u662f\u4e00\u79cd\u517c\u5bb9\u63aa\u65bd\uff0c\u65e2\u80fd\u88ab WarLauncher \u542f\u52a8\uff0c\u4e5f\u80fd\u517c\u5bb9 Servlet \u5bb9\u5668\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c JarLauncher \u548c WarLauncher \u5e76\u65e0\u672c\u8d28\u5dee\u522b\u3002","title":"7. WarLauncher\u7684\u5dee\u5f02"},{"location":"SpringBoot/02-spring-boot-maven-dependency/","text":"02 - \u56fa\u5316\u7684Maven\u4f9d\u8d56 \u4e4b\u524d\u5df2\u7ecf\u4f7f\u7528\u7684 org.springframework.boot:spring-boot-starter-web \u548c org.springframework.boot:spring-boot-loader \u5747\u7ee7\u627f\u81ea org.springframework.boot:spring-boot-starter-parent \uff0c\u6bd4\u5982\u7248\u672c\u4fe1\u606f\uff0c\u8fd9\u4e9b\u662fMaven\u4f9d\u8d56\u7ba1\u7406\u7684\u8303\u7574\uff0c\u964d\u4f4e\u4e86Spring Boot\u4f9d\u8d56\u7ba1\u7406\u7684\u6210\u672c\u3002 \u800c\u914d\u7f6e org.springframework.boot:spring-boot-starter-parent \u4e5f\u5b58\u5728\u4e00\u5b9a\u7684\u9650\u5236\uff0c\u56e0\u4e3a\u662f\u5355\u7ee7\u627f\u65b9\u5f0f\uff0c\u9650\u5236\u4e86\u5176\u4f9d\u8d56\u4ec5\u662fSpring Boot\u76f8\u5173\u3002\u82e5\u8981\u9700\u8981\u56fa\u5316\u5176\u4ed6\u7c7b\u578b\u7684\u4f9d\u8d56\u5c31\u6bd4\u8f83\u9ebb\u70e6\uff0c\u6216\u8005\u5e94\u7528\u7684 pom.xml \u6709\u81ea\u5b9a\u4e49\u7684parent\u3002 \u5728\u5b98\u65b9\u6587\u6863 ( https://docs.spring.io/spring-boot/docs/current/maven-plugin/reference/html/ ) \u4e2d\uff0c\u4ecb\u7ecd\u4e86\u76f8\u5173\u5185\u5bb9\uff1a Using Spring Boot without the Parent POM There may be reasons for you not to inherit from the spring-boot-starter-parent POM. You may have your own corporate standard parent that you need to use or you may prefer to explicitly declare all your Maven configuration. If you do not want to use the spring-boot-starter-parent , you can still keep the benefit of the dependency management (but not the plugin management) by using an import scoped dependency, as follows: <dependencyManagement> <dependencies> <dependency> <!-- Import dependency management from Spring Boot --> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-dependencies </artifactId> <version> 2.3.2.RELEASE </version> <type> pom </type> <scope> import </scope> </dependency> </dependencies> </dependencyManagement> \u5bf9\u793a\u4f8b\u9879\u76ee\u4f5c\u51fa\u8c03\u6574\uff0c\u4fee\u6539 pom.xml \u6587\u4ef6\uff1a <project xmlns= \"http://maven.apache.org/POM/4.0.0\" xmlns:xsi= \"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation= \"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\" > <modelVersion> 4.0.0 </modelVersion> <groupId> deep-in-spring-boot </groupId> <artifactId> first-spring-boot-application </artifactId> <packaging> war </packaging> <version> 1.0.0-SNAPSHOT </version> <name> first-spring-boot-application </name> <!-- <parent>--> <!-- <groupId>org.springframework.boot</groupId>--> <!-- <artifactId>spring-boot-starter-parent</artifactId>--> <!-- <version>2.3.2.RELEASE</version>--> <!-- </parent>--> <dependencies> <dependency> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-starter-web </artifactId> <version> 2.3.2.RELEASE </version> </dependency> <dependency> <groupId> junit </groupId> <artifactId> junit </artifactId> <version> 3.8.1 </version> <scope> test </scope> </dependency> <!-- spring-boot-loader \u5206\u6790 --> <dependency> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-loader </artifactId> <scope> provided </scope> </dependency> </dependencies> <dependencyManagement> <dependencies> <dependency> <!-- Import dependency management from Spring Boot --> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-dependencies </artifactId> <version> 2.3.2.RELEASE </version> <type> pom </type> <scope> import </scope> </dependency> </dependencies> </dependencyManagement> <build> <plugins> <plugin> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-maven-plugin </artifactId> </plugin> </plugins> </build> </project> \u53bb\u6389 <parent> \u5143\u7d20\uff0c\u6dfb\u52a0\u4e86 spring-boot-dependencies \uff0c\u4e4b\u540e\u91cd\u65b0\u6253\u5305\uff1a $ mvn clean package [INFO] Scanning for projects... [INFO] [INFO] ---------< deep-in-spring-boot:first-spring-boot-application >---------- [INFO] Building first-spring-boot-application 1.0.0-SNAPSHOT [INFO] --------------------------------[ war ]--------------------------------- [INFO] [INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ first-spring-boot-application --- [INFO] Deleting /Users/nanlei/Dev/Workspace/first-spring-boot-application/target [INFO] [INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ first-spring-boot-application --- [WARNING] Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform dependent! [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/main/resources [INFO] [INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ first-spring-boot-application --- [INFO] Changes detected - recompiling the module! [WARNING] File encoding has not been set, using platform encoding UTF-8, i.e. build is platform dependent! [INFO] Compiling 1 source file to /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/classes [INFO] [INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ first-spring-boot-application --- [WARNING] Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform dependent! [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/test/resources [INFO] [INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ first-spring-boot-application --- [INFO] Changes detected - recompiling the module! [WARNING] File encoding has not been set, using platform encoding UTF-8, i.e. build is platform dependent! [INFO] Compiling 1 source file to /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/test-classes [INFO] [INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ first-spring-boot-application --- [INFO] Surefire report directory: /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/surefire-reports ------------------------------------------------------- T E S T S ------------------------------------------------------- Running deep.in.spring.boot.AppTest Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec Results : Tests run: 1, Failures: 0, Errors: 0, Skipped: 0 [INFO] [INFO] --- maven-war-plugin:2.2:war (default-war) @ first-spring-boot-application --- [INFO] Packaging webapp [INFO] Assembling webapp [first-spring-boot-application] in [/Users/nanlei/Dev/Workspace/first-spring-boot-application/target/first-spring-boot-application-1.0.0-SNAPSHOT] [INFO] Processing war project [INFO] Webapp assembled in [133 msecs] [INFO] Building war: /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/first-spring-boot-application-1.0.0-SNAPSHOT.war [INFO] ------------------------------------------------------------------------ [INFO] BUILD FAILURE [INFO] ------------------------------------------------------------------------ [INFO] Total time: 1.686 s [INFO] Finished at: 2020-08-04T11:11:26+08:00 [INFO] ------------------------------------------------------------------------ [ERROR] Failed to execute goal org.apache.maven.plugins:maven-war-plugin:2.2:war (default-war) on project first-spring-boot-application: Error assembling WAR: webxml attribute is required (or pre-existing WEB-INF/web.xml if executing in update mode) -> [Help 1] [ERROR] [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch. [ERROR] Re-run Maven using the -X switch to enable full debug logging. [ERROR] [ERROR] For more information about the errors and possible solutions, please read the following articles: [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException \u6253\u5305\u5931\u8d25\u4e86\uff0c\u9519\u8bef\u539f\u56e0\u662fweb\u5e94\u7528\u7684\u90e8\u7f72\u63cf\u8ff0\u6587\u4ef6 WEB-INF/web.xml \u5728\u9879\u76ee\u4e2d\u5e76\u4e0d\u5b58\u5728\uff0c\u5f53\u8bbe\u7f6e pom.xml \u7684 <packaging>war</packaging> \u65f6\uff0cMaven\u4f1a\u6267\u884c maven-war-plugin:2.2 \uff0c WEB-INF/web.xml \u5c31\u662f\u5fc5\u987b\u7684\u3002\u4f46\u662f\uff0c\u5728\u4f5c\u51fa\u8c03\u6574\u4e4b\u524d\u5374\u6ca1\u6709\u8fd9\u4e2a\u95ee\u9898\uff0c\u90a3\u4e48\u95ee\u9898\u5c31\u5728 spring-boot-dependencies \u548c spring-boot-starter-parent \u7684\u5dee\u522b\u4e4b\u4e2d\u3002 \u67e5\u770b spring-boot-starter-parent-2.3.2.RELEASE.pom <?xml version=\"1.0\" encoding=\"UTF-8\"?> <project xmlns= \"http://maven.apache.org/POM/4.0.0\" xsi:schemaLocation= \"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\" xmlns:xsi= \"http://www.w3.org/2001/XMLSchema-instance\" > <modelVersion> 4.0.0 </modelVersion> <parent> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-dependencies </artifactId> <version> 2.3.2.RELEASE </version> </parent> <artifactId> spring-boot-starter-parent </artifactId> <packaging> pom </packaging> <name> spring-boot-starter-parent </name> <description> Parent pom providing dependency and plugin management for applications built with Maven </description> ... </project> \u53ef\u4ee5\u770b\u51fa spring-boot-dependencies \u662f spring-boot-starter-parent \u7684 parent \uff0c\u4e5f\u5c31\u662f\u8bf4\u53ef\u4ee5\u5c06 spring-boot-dependencies \u76f4\u63a5\u4f5c\u4e3a parent \u3002 \u67e5\u770b spring-boot-dependencies-2.3.2.RELEASE.pom \uff0c\u53ef\u4ee5\u770b\u5230 <?xml version=\"1.0\" encoding=\"UTF-8\"?> <project xmlns= \"http://maven.apache.org/POM/4.0.0\" xsi:schemaLocation= \"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\" xmlns:xsi= \"http://www.w3.org/2001/XMLSchema-instance\" > <modelVersion> 4.0.0 </modelVersion> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-dependencies </artifactId> <version> 2.3.2.RELEASE </version> <packaging> pom </packaging> <name> spring-boot-dependencies </name> <description> Spring Boot Dependencies </description> ... <properties> ... <spring-boot.version> 2.3.2.RELEASE </spring-boot.version> ... <maven-war-plugin.version> 3.2.3 </maven-war-plugin.version> ... </properties> <dependencyManagement> ... <dependency> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-starter-web </artifactId> <version> ${spring-boot.version} </version> </dependency> ... </dependencyManagement> <build> <pluginManagement> <plugins> ... <plugin> <groupId> org.apache.maven.plugins </groupId> <artifactId> maven-war-plugin </artifactId> <version> ${maven-war-plugin.version} </version> </plugin> ... </plugins> </pluginManagement> </build> </project> \u65e0\u8bba\u662fSpring Boot\u7684\u4f9d\u8d56 spring-boot-starter-web \u7b49\uff0c\u8fd8\u662f\u63d2\u4ef6 maven-war-plugin \u7b49\uff0c\u5747\u5b9a\u4e49\u5728\u6b64\u5904\u3002\u5f53\u9879\u76ee pom.xml \u6587\u4ef6\u7528 <parent> \u65b9\u5f0f\u5f15\u5165 spring-boot-starter-parent \u65f6\uff0c mvn package \u5c06\u4f7f\u7528 maven-war-plugin:3.2.3 \u548c spring-boot-maven-plugin:2.3.2.RELEASE \u3002 \u76f8\u53cd\uff0c <dependencyManagement> \u65b9\u5f0f\u5bfc\u5165 spring-boot-dependencies \u5c3d\u7ba1\u548c\u524d\u8005\u76f8\u540c\uff0c\u4f46\u6b64\u65f6\u4ec5\u5173\u6ce8 <dependencyManagement> \uff0c\u6240\u4ee5 maven-war-plugin \u91c7\u7528\u7684\u7248\u672c\u662f2.2\uff0c\u624b\u52a8\u6dfb\u52a0 maven-war-plugin:3.2.3 \u5230\u9879\u76ee pom.xml \u4e2d\uff1a <project xmlns= \"http://maven.apache.org/POM/4.0.0\" xmlns:xsi= \"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation= \"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\" > ... <build> <plugins> <plugin> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-maven-plugin </artifactId> <version> 2.3.2.RELEASE </version> </plugin> <!-- \u4fdd\u6301\u548cspring-boot-dependencies\u7248\u672c\u4e00\u81f4 --> <plugin> <groupId> org.apache.maven.plugins </groupId> <artifactId> maven-war-plugin </artifactId> <version> 3.2.3 </version> </plugin> </plugins> </build> </project> \u518d\u6b21\u6267\u884c\u6253\u5305\uff1a $ mvn clean package [INFO] Scanning for projects... [INFO] [INFO] ---------< deep-in-spring-boot:first-spring-boot-application >---------- [INFO] Building first-spring-boot-application 1.0.0-SNAPSHOT [INFO] --------------------------------[ war ]--------------------------------- [INFO] [INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ first-spring-boot-application --- [INFO] Deleting /Users/nanlei/Dev/Workspace/first-spring-boot-application/target [INFO] [INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ first-spring-boot-application --- [WARNING] Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform dependent! [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/main/resources [INFO] [INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ first-spring-boot-application --- [INFO] Changes detected - recompiling the module! [WARNING] File encoding has not been set, using platform encoding UTF-8, i.e. build is platform dependent! [INFO] Compiling 1 source file to /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/classes [INFO] [INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ first-spring-boot-application --- [WARNING] Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform dependent! [INFO] skip non existing resourceDirectory /Users/nanlei/Dev/Workspace/first-spring-boot-application/src/test/resources [INFO] [INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ first-spring-boot-application --- [INFO] Changes detected - recompiling the module! [WARNING] File encoding has not been set, using platform encoding UTF-8, i.e. build is platform dependent! [INFO] Compiling 1 source file to /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/test-classes [INFO] [INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ first-spring-boot-application --- [INFO] Surefire report directory: /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/surefire-reports ------------------------------------------------------- T E S T S ------------------------------------------------------- Running deep.in.spring.boot.AppTest Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 sec Results : Tests run: 1, Failures: 0, Errors: 0, Skipped: 0 [INFO] [INFO] --- maven-war-plugin:3.2.3:war (default-war) @ first-spring-boot-application --- [INFO] Packaging webapp [INFO] Assembling webapp [first-spring-boot-application] in [/Users/nanlei/Dev/Workspace/first-spring-boot-application/target/first-spring-boot-application-1.0.0-SNAPSHOT] [INFO] Processing war project [INFO] Webapp assembled in [110 msecs] [INFO] Building war: /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/first-spring-boot-application-1.0.0-SNAPSHOT.war [INFO] ------------------------------------------------------------------------ [INFO] BUILD SUCCESS [INFO] ------------------------------------------------------------------------ [INFO] Total time: 2.441 s [INFO] Finished at: 2020-08-04T13:40:35+08:00 [INFO] ------------------------------------------------------------------------ \u6b64\u65f6\u6253\u5305\u53ef\u4ee5\u6210\u529f\uff0c\u542f\u52a8\u7a0b\u5e8f\uff1a $ java -jar target/first-spring-boot-application-1.0.0-SNAPSHOT.war no main manifest attribute, in target/first-spring-boot-application-1.0.0-SNAPSHOT.war \u6ca1\u6709\u53d1\u73b0 MANIFEST.MF \uff0c\u8bf4\u660e spring-boot-maven-plugin \u6ca1\u6709\u6267\u884c\uff0c\u5b98\u65b9\u6587\u6863\u5bf9\u6b64\u6709\u8be6\u7ec6\u8bf4\u660e\uff1a Create an Executable JAR with Maven The spring-boot-maven-plugin can be used to create an executable \u201cfat\u201d JAR. If you use the spring-boot-starter-parent POM, you can declare the plugin and your jars are repackaged as follows: <build> <plugins> <plugin> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-maven-plugin </artifactId> </plugin> </plugins> </build> If you do not use the parent POM, you can still use the plugin. However, you must additionally add an <executions> section, as follows: <build> <plugins> <plugin> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-maven-plugin </artifactId> <version> 2.3.2.RELEASE </version> <executions> <execution> <goals> <goal> repackage </goal> </goals> </execution> </executions> </plugin> </plugins> </build> \u5bf9 pring-boot-maven-plugin \u8bbe\u7f6e execution \u7684 goal \u4e3a repackage \u540e\uff0c\u518d\u6b21\u6253\u5305\uff1a $ mvn clean package [INFO] Scanning for projects... (\u7701\u7565\u90e8\u5206\u5185\u5bb9...) [INFO] --- maven-war-plugin:3.2.3:war (default-war) @ first-spring-boot-application --- [INFO] Packaging webapp [INFO] Assembling webapp [first-spring-boot-application] in [/Users/nanlei/Dev/Workspace/first-spring-boot-application/target/first-spring-boot-application-1.0.0-SNAPSHOT] [INFO] Processing war project [INFO] Webapp assembled in [116 msecs] [INFO] Building war: /Users/nanlei/Dev/Workspace/first-spring-boot-application/target/first-spring-boot-application-1.0.0-SNAPSHOT.war [INFO] [INFO] --- spring-boot-maven-plugin:2.3.2.RELEASE:repackage (default) @ first-spring-boot-application --- [INFO] Replacing main artifact with repackaged archive [INFO] ------------------------------------------------------------------------ [INFO] BUILD SUCCESS [INFO] ------------------------------------------------------------------------ [INFO] Total time: 3.028 s [INFO] Finished at: 2020-08-04T13:56:06+08:00 [INFO] ------------------------------------------------------------------------ Maven\u65e5\u5fd7\u4e2d\u663e\u793a\u4e86 spring-boot-maven-plugin:2.3.2.RELEASE \u63d2\u4ef6\u7684\u6267\u884c\u4fe1\u606f\uff0c\u518d\u6b21\u542f\u52a8\u7a0b\u5e8f\uff1a $ java -jar target/first-spring-boot-application-1.0.0-SNAPSHOT.war . ____ _ __ _ _ /\\\\ / ___'_ __ _ _(_)_ __ __ _ \\ \\ \\ \\ ( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| | ) ) ) ) ' |____| .__|_| |_|_| |_\\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: (v2.3.2.RELEASE) 2020-08-04 13:58:03.282 INFO 4253 --- [ main] deep.in.spring.boot.App : Starting App on nanleis-MacBook-Pro.local with PID 4253 (/Users/nanlei/Dev/Workspace/first-spring-boot-application/target/first-spring-boot-application-1.0.0-SNAPSHOT.war started by nanlei in /Users/nanlei/Dev/Workspace/first-spring-boot-application) 2020-08-04 13:58:03.285 INFO 4253 --- [ main] deep.in.spring.boot.App : No active profile set, falling back to default profiles: default 2020-08-04 13:58:04.239 INFO 4253 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat initialized with port(s): 8080 (http) 2020-08-04 13:58:04.251 INFO 4253 --- [ main] o.apache.catalina.core.StandardService : Starting service [Tomcat] 2020-08-04 13:58:04.251 INFO 4253 --- [ main] org.apache.catalina.core.StandardEngine : Starting Servlet engine: [Apache Tomcat/9.0.37] 2020-08-04 13:58:04.682 INFO 4253 --- [ main] o.a.c.c.C.[Tomcat].[localhost].[/] : Initializing Spring embedded WebApplicationContext 2020-08-04 13:58:04.682 INFO 4253 --- [ main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1342 ms 2020-08-04 13:58:04.843 INFO 4253 --- [ main] o.s.s.concurrent.ThreadPoolTaskExecutor : Initializing ExecutorService 'applicationTaskExecutor' 2020-08-04 13:58:05.092 INFO 4253 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat started on port(s): 8080 (http) with context path '' 2020-08-04 13:58:05.105 INFO 4253 --- [ main] deep.in.spring.boot.App : Started App in 2.212 seconds (JVM running for 2.633) \u81f3\u6b64\u9879\u76ee\u53ef\u4ee5\u6b63\u5e38\u542f\u52a8\u4e86\uff0c\u5728\u8c03\u6574\u4f9d\u8d56\u914d\u7f6e\u7684\u8fc7\u7a0b\u4e2d( <parent> \u65b9\u5f0f\u5230 <dependencyManagement> \u65b9\u5f0f)\uff0c\u9047\u5230\u4e86\u5982\u4e0b\u95ee\u9898\uff1a maven-war-plugin \u63d2\u4ef6\u5728\u7248\u672c\u4e0a\u7684\u5dee\u5f02 2.2 \u7248\u672c\u9ed8\u8ba4\u7684\u6253\u5305\u89c4\u5219\u662f\u5fc5\u987b\u5b58\u5728Web\u5e94\u7528\u90e8\u7f72\u63cf\u8ff0\u6587\u4ef6 WEB-INF/web.xml 3.2.3 \u7248\u672c\u4e2d\u5219\u8c03\u6574\u4e86\u8be5\u884c\u4e3a spring-boot-maven-plugin \u63d2\u4ef6\u5728\u4f7f\u7528\u65f6\u6ce8\u610f\u6dfb\u52a0 repackage \u7684 goal \uff0c\u5426\u5219\u53ef\u80fd\u4e0d\u4f1a\u6dfb\u52a0Spring Boot\u7684\u5f15\u5bfc\u4f9d\u8d56\uff0c\u4ece\u800c\u65e0\u6cd5\u542f\u52a8\u7a0b\u5e8f \u51fa\u4e8e\u4e60\u60ef\uff0c\u901a\u5e38\u4e0d\u5c06 spring-boot-dependencies \u76f4\u63a5\u4f5c\u4e3a <parent> \uff0c\u5c3d\u7ba1 spring-boot-starter-parent \u4e5f\u53ea\u662f\u7b80\u5355\u7ee7\u627f\u4e86 spring-boot-dependencies","title":"Maven Dependencies"}]}